(()=>{var e={689:()=>{!function(e){"use strict";var t=e.escapeEntities,n=e.escapeUriScheme,r=e.dom,o=e.utils,i=r.css,a=r.attr,l=r.is,s=o.extend,c=o.each,u="data-sceditor-emoticon",d=e.command.get,f={always:1,never:2,auto:3},p={bold:{txtExec:["[b]","[/b]"]},italic:{txtExec:["[i]","[/i]"]},underline:{txtExec:["[u]","[/u]"]},strike:{txtExec:["[s]","[/s]"]},subscript:{txtExec:["[sub]","[/sub]"]},superscript:{txtExec:["[sup]","[/sup]"]},left:{txtExec:["[left]","[/left]"]},center:{txtExec:["[center]","[/center]"]},right:{txtExec:["[right]","[/right]"]},justify:{txtExec:["[justify]","[/justify]"]},font:{txtExec:function(e){var t=this;d("font")._dropDown(t,e,(function(e){t.insertText("[font="+e+"]","[/font]")}))}},size:{txtExec:function(e){var t=this;d("size")._dropDown(t,e,(function(e){t.insertText("[size="+e+"]","[/size]")}))}},color:{txtExec:function(e){var t=this;d("color")._dropDown(t,e,(function(e){t.insertText("[color="+e+"]","[/color]")}))}},bulletlist:{txtExec:function(e,t){this.insertText("[ul]\n[li]"+t.split(/\r?\n/).join("[/li]\n[li]")+"[/li]\n[/ul]")}},orderedlist:{txtExec:function(e,t){this.insertText("[ol]\n[li]"+t.split(/\r?\n/).join("[/li]\n[li]")+"[/li]\n[/ol]")}},table:{txtExec:["[table][tr][td]","[/td][/tr][/table]"]},horizontalrule:{txtExec:["[hr]"]},code:{txtExec:["[code]","[/code]"]},image:{txtExec:function(e,t){var n=this;d("image")._dropDown(n,e,t,(function(e,t,r){var o="";t&&(o+=" width="+t),r&&(o+=" height="+r),n.insertText("[img"+o+"]"+e+"[/img]")}))}},email:{txtExec:function(e,t){var n=this;d("email")._dropDown(n,e,(function(e,r){n.insertText("[email="+e+"]"+(r||t||e)+"[/email]")}))}},link:{txtExec:function(e,t){var n=this;d("link")._dropDown(n,e,(function(e,r){n.insertText("[url="+e+"]"+(r||t||e)+"[/url]")}))}},quote:{txtExec:["[quote]","[/quote]"]},youtube:{txtExec:function(e){var t=this;d("youtube")._dropDown(t,e,(function(e){t.insertText("[youtube]"+e+"[/youtube]")}))}},rtl:{txtExec:["[rtl]","[/rtl]"]},ltr:{txtExec:["[ltr]","[/ltr]"]}},m={b:{tags:{b:null,strong:null},styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{tags:{u:null},styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{tags:{s:null,strike:null},styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},font:{tags:{font:{face:null}},styles:{"font-family":null},quoteType:f.never,format:function(e,t){var n;return"[font="+v(n=l(e,"font")&&(n=a(e,"face"))?n:i(e,"font-family"))+"]"+t+"[/font]"},html:'<font face="{defaultattr}">{0}</font>'},size:{tags:{font:{size:null}},styles:{"font-size":null},format:function(e,t){var n=a(e,"size"),r=2;return-1<(n=n||i(e,"fontSize")).indexOf("px")?((n=+n.replace("px",""))<12&&(r=1),15<n&&(r=3),17<n&&(r=4),23<n&&(r=5),31<n&&(r=6),47<n&&(r=7)):r=n,"[size="+r+"]"+t+"[/size]"},html:'<font size="{defaultattr}">{!0}</font>'},color:{tags:{font:{color:null}},styles:{color:null},quoteType:f.never,format:function(e,t){var n;return"[color="+S(n=l(e,"font")&&(n=a(e,"color"))?n:e.style.color||i(e,"color"))+"]"+t+"[/color]"},html:function(e,n,r){return'<font color="'+t(S(n.defaultattr),!0)+'">'+r+"</font>"}},ul:{tags:{ul:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{breakStart:!0,isInline:!1,skipLastLineBreak:!0,html:"<ul>{0}</ul>"},ol:{tags:{ol:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},isInline:!1,closedBy:["/ul","/ol","/list","*","li"],format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{isInline:!1,closedBy:["/ul","/ol","/list","*","li"],html:"<li>{0}</li>"},table:{tags:{table:null},isInline:!1,isHtmlInline:!0,skipLastLineBreak:!0,format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},isInline:!1,skipLastLineBreak:!0,format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},allowsEmpty:!0,isInline:!1,format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},allowsEmpty:!0,isInline:!1,format:"[td]{0}[/td]",html:"<td>{0}</td>"},emoticon:{allowsEmpty:!0,tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(e,t){return a(e,u)+t},html:"{0}"},hr:{tags:{hr:null},allowsEmpty:!0,isSelfClosing:!0,isInline:!1,format:"[hr]{0}",html:"<hr />"},img:{allowsEmpty:!0,tags:{img:{src:null}},allowedChildren:["#"],quoteType:f.never,format:function(e,t){function n(t){return e.style?e.style[t]:null}var o,i="";return a(e,u)?t:(t=a(e,"width")||n("width"),o=a(e,"height")||n("height"),"[img"+(i=e.complete&&(t||o)||t&&o?"="+r.width(e)+"x"+r.height(e):i)+"]"+a(e,"src")+"[/img]")},html:function(e,r,o){var i="",a=r.width,l=r.height;return r.defaultattr&&(a=(r=r.defaultattr.split(/x/i))[0],l=2===r.length?r[1]:r[0]),void 0!==a&&(i+=' width="'+t(a,!0)+'"'),void 0!==l&&(i+=' height="'+t(l,!0)+'"'),"<img"+i+' src="'+n(o)+'" />'}},url:{allowsEmpty:!0,tags:{a:{href:null}},quoteType:f.never,format:function(e,t){return"mailto:"===(e=a(e,"href")).substr(0,7)?'[email="'+e.substr(7)+'"]'+t+"[/email]":"[url="+e+"]"+t+"[/url]"},html:function(e,r,o){return r.defaultattr=t(r.defaultattr,!0)||o,'<a href="'+n(r.defaultattr)+'">'+o+"</a>"}},email:{quoteType:f.never,html:function(e,n,r){return'<a href="mailto:'+(t(n.defaultattr,!0)||r)+'">'+r+"</a>"}},quote:{tags:{blockquote:null},isInline:!1,quoteType:f.never,format:function(e,t){for(var n,r="data-author",o="",i=e.children,s=0;!n&&s<i.length;s++)l(i[s],"cite")&&(n=i[s]);return(n||a(e,r))&&(o=n&&n.textContent||a(e,r),a(e,r,o),n&&e.removeChild(n),t=this.elementToBbcode(e),o="="+o.replace(/(^\s+|\s+$)/g,""),n&&e.insertBefore(n,e.firstChild)),"[quote"+o+"]"+t+"[/quote]"},html:function(e,n,r){return"<blockquote>"+(r=n.defaultattr?"<cite>"+t(n.defaultattr)+"</cite>"+r:r)+"</blockquote>"}},code:{tags:{code:null},isInline:!1,allowedChildren:["#","#newline"],format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},isInline:!1,allowsEmpty:!0,format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},isInline:!1,allowsEmpty:!0,format:"[center]{0}[/center]",html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},isInline:!1,allowsEmpty:!0,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},isInline:!1,allowsEmpty:!0,format:"[justify]{0}[/justify]",html:'<div align="justify">{0}</div>'},youtube:{allowsEmpty:!0,tags:{iframe:{"data-youtube-id":null}},format:function(e,t){return(e=a(e,"data-youtube-id"))?"[youtube]"+e+"[/youtube]":t},html:'<iframe width="560" height="315" frameborder="0" src="https://www.youtube-nocookie.com/embed/{0}?wmode=opaque" data-youtube-id="{0}" allowfullscreen></iframe>'},rtl:{styles:{direction:["rtl"]},isInline:!1,format:"[rtl]{0}[/rtl]",html:'<div style="direction: rtl">{0}</div>'},ltr:{styles:{direction:["ltr"]},isInline:!1,format:"[ltr]{0}[/ltr]",html:'<div style="direction: ltr">{0}</div>'},ignore:{}};function h(e,n){return e.replace(/\{([^}]+)\}/g,(function(e,r){var o=!0;return"!"===r.charAt(0)&&(o=!1,r=r.substring(1)),"0"===r&&(o=!1),void 0===n[r]?e:o?t(n[r],!0):n[r]}))}function g(e){return"function"==typeof e}function v(e){return e&&e.replace(/\\(.)/g,"$1").replace(/^(["'])(.*?)\1$/,"$2")}var y="open",b="content",x="newline",w="close";function C(e,t,n,r,o,i){var a=this;a.type=e,a.name=t,a.val=n,a.attrs=r||{},a.children=o||[],a.closing=i||null}function E(e){var n=this;function r(e,t){var n,r,o;return e===y&&(n=t.match(/\[([^\]\s=]+)(?:([^\]]+))?\]/))&&(o=u(n[1]),n[2]&&(n[2]=n[2].trim())&&(r=function(e){var t,n=/([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g,r={};if("="===e.charAt(0)&&e.indexOf("=",1)<0)r.defaultattr=v(e.substr(1));else for("="===e.charAt(0)&&(e="defaultattr"+e);t=n.exec(e);)r[u(t[1])]=v(t[3])||t[4];return r}(n[2]))),e===w&&(n=t.match(/\[\/([^\[\]]+)\]/))&&(o=u(n[1])),(o=e===x?"#newline":o)&&(e!==y&&e!==w||m[o])||(e=b,o="#"),new C(e,o,t,r)}function o(e,t,n){for(var r=n.length;r--;)if(n[r].type===t&&n[r].name===e)return 1}function i(e,t){return e=(e?m[e.name]:{}).allowedChildren,!n.opts.fixInvalidChildren||!e||-1<e.indexOf(t.name||"#")}function a(e,r){for(var o,i,l,s,c,u,d="",f=function(e){return!1!==(!e||(void 0!==e.isHtmlInline?e.isHtmlInline:e.isInline))};0<e.length;)if(o=e.shift()){if(o.type===y)u=o.children[o.children.length-1]||{},i=m[o.name],s=r&&f(i),l=a(o.children,!1),u=i&&i.html?(f(i)||!f(m[u.name])||i.isPreFormatted||i.skipLastLineBreak||(l+="<br />"),g(i.html)?i.html.call(n,o,o.attrs,l):(o.attrs[0]=l,h(i.html,o.attrs))):o.val+l+(o.closing?o.closing.val:"");else{if(o.type===x){if(!r){d+="<br />";continue}c||(d+="<div>"),d+="<br />",e.length||(d+="<br />"),d+="</div>\n",c=!1;continue}s=r,u=t(o.val,!0)}s&&!c?(d+="<div>",c=!0):!s&&c&&(d+="</div>\n",c=!1),d+=u}return c&&(d+="</div>\n"),d}function l(e,t,n){var r=/\s|=/.test(e);return g(t)?t(e,n):t===f.never||t===f.auto&&!r?e:'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}function c(e){return e.length?e[e.length-1]:null}function u(e){return e.toLowerCase()}n.opts=s({},E.defaults,e),n.tokenize=function(e){var t,n,o,i=[],a=[{type:b,regex:/^([^\[\r\n]+|\[)/},{type:x,regex:/^(\r\n|\r|\n)/},{type:y,regex:/^\[[^\[\]]+\]/},{type:w,regex:/^\[\/[^\[\]]+\]/}];e:for(;e.length;){for(o=a.length;o--;)if(n=a[o].type,(t=e.match(a[o].regex))&&t[0]){i.push(r(n,t[0])),e=e.substr(t[0].length);continue e}e.length&&i.push(r(b,e)),e=""}return i},n.parse=function(e,t){e=function(e){function t(){return c(g)}function r(e){(t()?t().children:h).push(e)}function a(e){return t()&&(s=m[t().name])&&s.closedBy&&-1<s.closedBy.indexOf(e)}for(var l,s,u,d,f,p=[],h=[],g=[];l=e.shift();)switch(f=e[0],i(t(),l)||l.type===w&&t()&&l.name===t().name||(l.name="#",l.type=b),l.type){case y:a(l.name)&&g.pop(),r(l),(s=m[l.name])&&!s.isSelfClosing&&(s.closedBy||o(l.name,w,e))?g.push(l):s&&s.isSelfClosing||(l.type=b);break;case w:if(t()&&l.name!==t().name&&a("/"+l.name)&&g.pop(),t()&&l.name===t().name)t().closing=l,g.pop();else if(o(l.name,y,g)){for(;u=g.pop();){if(u.name===l.name){u.closing=l;break}u=u.clone(),p.length&&u.children.push(c(p)),p.push(u)}for(f&&f.type===x&&(s=m[l.name])&&!1===s.isInline&&(r(f),e.shift()),r(c(p)),d=p.length;d--;)g.push(p[d]);p.length=0}else l.type=b,r(l);break;case x:t()&&f&&a((f.type===w?"/":"")+f.name)&&(f.type===w&&f.name===t().name||((s=m[t().name])&&s.breakAfter||s&&!1===s.isInline&&n.opts.breakAfterBlock&&!1!==s.breakAfter)&&g.pop()),r(l);break;default:r(l)}return h}(n.tokenize(e));var r=n.opts;return r.fixInvalidNesting&&function e(t,n,r,o){var a,l,s,u,d=function(e){return!(e=m[e.name])||!1!==e.isInline};for(n=n||[],o=o||t,l=0;l<t.length;l++)if((a=t[l])&&a.type===y){var f,p;if(r&&!d(a)&&(u=(p=c(n)).splitAt(a),s=1<n.length?n[n.length-2].children:o,i(a,p)&&((f=p.clone()).children=a.children,a.children=[f]),-1<(f=s.indexOf(p))))return u.children.splice(0,1),s.splice(f+1,0,a,u),void((p=u.children[0])&&p.type===x&&!d(a)&&(u.children.splice(0,1),s.splice(f+2,0,p)));n.push(a),e(a.children,n,r||d(a),o),n.pop()}}(e),function e(t,r,o){var i,a,l,s,c,u,d,f,p=t.length;r&&(s=m[r.name]);for(var h=p;h--;)(i=t[h])&&(i.type===x?(a=0<h?t[h-1]:null,l=h<p-1?t[h+1]:null,f=!1,!o&&s&&!0!==s.isSelfClosing&&(a?u||l||(!1===s.isInline&&n.opts.breakEndBlock&&!1!==s.breakEnd&&(f=!0),s.breakEnd&&(f=!0),u=f):(!1===s.isInline&&n.opts.breakStartBlock&&!1!==s.breakStart&&(f=!0),s.breakStart&&(f=!0))),a&&a.type===y&&(c=m[a.name])&&(o?!1===c.isInline&&(f=!0):(!1===c.isInline&&n.opts.breakAfterBlock&&!1!==c.breakAfter&&(f=!0),c.breakAfter&&(f=!0))),!o&&!d&&l&&l.type===y&&(c=m[l.name])&&(!1===c.isInline&&n.opts.breakBeforeBlock&&!1!==c.breakBefore&&(f=!0),c.breakBefore&&(f=!0),d=f)?t.splice(h,1):(f&&t.splice(h,1),d=!1)):i.type===y&&e(i.children,i,o))}(e,null,t),r.removeEmptyTags&&function e(t){for(var n,r,o=function(e){for(var t=e.length;t--;){var n=e[t].type;if(n===y||n===w)return!1;if(n===b&&/\S|\u00A0/.test(e[t].val))return!1}return!0},i=t.length;i--;)(n=t[i])&&n.type===y&&(r=m[n.name],e(n.children),o(n.children)&&r&&!r.isSelfClosing&&!r.allowsEmpty&&t.splice.apply(t,[i,1].concat(n.children)))}(e),e},n.toHTML=function(e,t){return a(n.parse(e,t),!0)},n.toHTMLFragment=function(e,t){return a(n.parse(e,t),!1)},n.toBBCode=function(e,t){return function e(t){for(var r,o,i,a,s,c,u,d,p,h="";0<t.length;)if(r=t.shift())if(p=!(!(i=m[r.name])||!1!==i.isInline),a=i&&i.isSelfClosing,c=p&&n.opts.breakBeforeBlock&&!1!==i.breakBefore||i&&i.breakBefore,u=p&&!a&&n.opts.breakStartBlock&&!1!==i.breakStart||i&&i.breakStart,d=p&&n.opts.breakEndBlock&&!1!==i.breakEnd||i&&i.breakEnd,p=p&&n.opts.breakAfterBlock&&!1!==i.breakAfter||i&&i.breakAfter,s=(i?i.quoteType:null)||n.opts.quoteType||f.auto,i||r.type!==y)if(r.type===y){if(c&&(h+="\n"),h+="["+r.name,r.attrs)for(o in r.attrs.defaultattr&&(h+="="+l(r.attrs.defaultattr,s,"defaultattr"),delete r.attrs.defaultattr),r.attrs)r.attrs.hasOwnProperty(o)&&(h+=" "+o+"="+l(r.attrs[o],s,o));h+="]",u&&(h+="\n"),r.children&&(h+=e(r.children)),a||i.excludeClosing||(d&&(h+="\n"),h+="[/"+r.name+"]"),p&&(h+="\n"),r.closing&&a&&(h+=r.closing.val)}else h+=r.val;else h+=r.val,r.children&&(h+=e(r.children)),r.closing&&(h+=r.closing.val);return h}(n.parse(e,t))}}function T(e){return e=parseInt(e,10),isNaN(e)?"00":(e=Math.max(0,Math.min(e,255)).toString(16)).length<2?"0"+e:e}function S(e){var t;return(t=(e=e||"#000").match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i))?"#"+T(t[1])+T(t[2])+T(t[3]):(t=e.match(/#([0-9a-f])([0-9a-f])([0-9a-f])\s*?$/i))?"#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]:e}function k(){var e=this,t=(e.stripQuotes=v,{}),n={ul:["li","ol","ul"],ol:["li","ol","ul"],table:["tr"],tr:["td","th"],code:["br","p","div"]};function o(n,o,i){function l(e){var t=e[0],o=(e=e[1],r.getStyle(n,t)),i=n.parentNode;return!(!o||i&&r.hasStyle(i,t,o))&&(!e||e.includes(o))}function s(r){t[r]&&t[r][i]&&c(t[r][i],(function(t,r){var i,s=m[t].strictMatch,c=(s=void 0===s?e.opts.strictMatch:s)?"every":"some";if(!r||r[c]((i=s,function(e){var t=e[0];return e=e[1],("style"!==t||"CODE"!==n.nodeName)&&("style"===t&&e?e[i?"every":"some"](l):(t=a(n,t))&&(!e||e.includes(t)))})))return r=m[t].format,o=g(r)?r.call(e,n,o):function(e){var t=arguments;return e.replace(/\{(\d+)\}/g,(function(e,n){return void 0!==t[+n+1]?t[+n+1]:"{"+n+"}"}))}(r,o),!1}))}return s("*"),s(n.nodeName.toLowerCase()),o}function d(e,t){return function e(t,i,s){var c="";return r.traverse(t,(function(t){var d="",f=t.nodeType,p=t.nodeName.toLowerCase(),m="code"===p,h="img"===p&&!!a(t,u),g=n[p],v=t.firstChild,y=!0;s&&(y=-1<s.indexOf(p),(y=!!h||y)||(g=s)),1===f?l(t,".sceditor-nlf")&&!v||("iframe"!==p&&(d=e(t,i||m,g)),y?(i&&!h||(m||(d=o(t,d,!1)),d=o(t,d,!0)),c+=function(e,t){var n=e.nodeName.toLowerCase(),o=r.isInline;if(!o(e,!0)||"br"===n){for(var i,a,s=e.previousSibling;s&&1===s.nodeType&&!l(s,"br")&&o(s,!0)&&!s.firstChild;)s=s.previousSibling;for(;i=((a=e.parentNode)&&a.lastChild)===e,(e=a)&&i&&o(a,!0););i&&"li"!==n||(t+="\n"),"br"!==n&&s&&!l(s,"br")&&o(s,!0)&&(t="\n"+t)}return t}(t,d)):c+=d):3===f&&(c+=t.nodeValue)}),!1,!0),c}(e,t)}function f(t,n,r){var o=new E(e.opts.parserOptions);return(t||r?o.toHTMLFragment:o.toHTML)(e.opts.bbcodeTrim?n.trim():n)}function h(t,n,o,a){o=o||document;var l,s=!!r.closest(a,"code"),c=o.createElement("div"),u=o.createElement("div"),f=new E(e.opts.parserOptions);for(u.innerHTML=n,i(c,"visibility","hidden"),c.appendChild(u),o.body.appendChild(c),t&&(c.insertBefore(o.createTextNode("#"),c.firstChild),c.appendChild(o.createTextNode("#"))),a&&i(u,"whiteSpace",i(a,"whiteSpace")),l=u.getElementsByClassName("sceditor-ignore");l.length;)l[0].parentNode.removeChild(l[0]);return r.removeWhiteSpace(c),n=d(u,s),o.body.removeChild(c),n=f.toBBCode(n,!0),e.opts.bbcodeTrim?n.trim():n}e.init=function(){e.opts=this.opts,e.elementToBbcode=d,c(m,(function(e,n){var r=!1===n.isInline,o=(n=m[e].tags,m[e].styles);o&&(t["*"]=t["*"]||{},t["*"][r]=t["*"][r]||{},t["*"][r][e]=[["style",Object.entries(o)]]),n&&c(n,(function(n,o){o&&o.style&&(o.style=Object.entries(o.style)),t[n]=t[n]||{},t[n][r]=t[n][r]||{},t[n][r][e]=o&&Object.entries(o)}))})),this.commands=s(!0,{},p,this.commands),this.toBBCode=e.toSource,this.fromBBCode=e.toHtml},e.toHtml=f.bind(null,!1),e.fragmentToHtml=f.bind(null,!0),e.toSource=h.bind(null,!1),e.fragmentToSource=h.bind(null,!0)}C.prototype={clone:function(){var e=this;return new C(e.type,e.name,e.val,s({},e.attrs),[],e.closing?e.closing.clone():null)},splitAt:function(e){var t,n=this.clone();return-1<(e=this.children.indexOf(e))&&(t=this.children.length-e,n.children=this.children.splice(e,t)),n}},E.QuoteType=f,E.defaults={breakBeforeBlock:!1,breakStartBlock:!1,breakEndBlock:!1,breakAfterBlock:!0,removeEmptyTags:!0,fixInvalidNesting:!0,fixInvalidChildren:!0,quoteType:f.auto,strictMatch:!1},k.get=function(e){return m[e]||null},k.set=function(e,t){return e&&t&&((t=s(m[e]||{},t)).remove=function(){delete m[e]},m[e]=t),this},k.rename=function(e,t){return e in m&&(m[t]=m[e],delete m[e]),this},k.remove=function(e){return e in m&&delete m[e],this},k.formatBBCodeString=h,e.formats.bbcode=k,e.BBCodeParser=E}(sceditor)},368:()=>{!function(){"use strict";function e(e,t){return typeof t===e}var t=e.bind(null,"string"),n=e.bind(null,"undefined"),r=e.bind(null,"function"),o=e.bind(null,"number");function i(e){return!Object.keys(e).length}function a(e,t){var r=e===!!e,o=r?2:1,i=r?t:e,l=r&&e;function s(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype}for(;o<arguments.length;o++){var c,u=arguments[o];for(c in u){var d,f,p=i[c],m=u[c];n(m)||"__proto__"!==c&&"constructor"!==c&&(f=s(m),d=Array.isArray(m),l&&(f||d)?(f=s(p)===f&&Array.isArray(p)===d,i[c]=a(!0,f?p:d?[]:{},m)):i[c]=m)}}return i}function l(e,t){-1<(t=e.indexOf(t))&&e.splice(t,1)}function s(e,t){if(Array.isArray(e)||"length"in e&&o(e.length))for(var n=0;n<e.length;n++)t(n,e[n]);else Object.keys(e).forEach((function(n){t(n,e[n])}))}var c={},u=1,d=3,f=8;function p(e){return e=parseFloat(e),isFinite(e)?e:0}function m(e,t,n){var r=(n||document).createElement(e);return s(t||{},(function(e,t){"style"===e?r.style.cssText=t:e in r?r[e]=t:r.setAttribute(e,t)})),r}function h(e,t){for(var n=e||{};(n=n.parentNode)&&!/(9|11)/.test(n.nodeType);)if(!t||D(n,t))return n}function g(e,t){return D(e,t)?e:h(e,t)}function v(e){e.parentNode&&e.parentNode.removeChild(e)}function y(e,t){e.appendChild(t)}function b(e,t){return e.querySelectorAll(t)}function x(e,n,r,o,i){n.split(" ").forEach((function(n){var a;t(r)?(a=o["_sce-event-"+n+r]||function(t){for(var n=t.target;n&&n!==e;){if(D(n,r))return void o.call(n,t);n=n.parentNode}},o["_sce-event-"+n+r]=a):(a=r,i=o),e.addEventListener(n,a,i||!1)}))}function w(e,n,r,o,i){n.split(" ").forEach((function(n){var a;t(r)?a=o["_sce-event-"+n+r]:(a=r,i=o),e.removeEventListener(n,a,i||!1)}))}function C(e,t,n){if(arguments.length<3)return e.getAttribute(t);null==n?E(e,t):e.setAttribute(t,n)}function E(e,t){e.removeAttribute(t)}function T(e){N(e,"display","none")}function S(e){N(e,"display","")}function k(e){(z(e)?T:S)(e)}function N(e,n,r){if(arguments.length<3){if(t(n))return 1===e.nodeType?getComputedStyle(e)[n]:null;s(n,(function(t,n){N(e,t,n)}))}else{var o=(r||0===r)&&!isNaN(r);e.style[n]=o?r+"px":r}}function A(e,t,n){var r=arguments.length,o={};if(e.nodeType===u)return 1===r?(s(e.attributes,(function(e,t){/^data\-/i.test(t.name)&&(o[t.name.substr(5)]=t.value)})),o):2===r?C(e,"data-"+t):void C(e,"data-"+t,String(n))}function D(e,t){return!(!e||e.nodeType!==u)&&(e.matches||e.msMatchesSelector||e.webkitMatchesSelector).call(e,t)}function R(e,t){t.parentNode.insertBefore(e,t)}function M(e){return e.className.trim().split(/\s+/)}function _(e,t){return D(e,"."+t)}function L(e,t){var n=M(e);n.indexOf(t)<0&&n.push(t),e.className=n.join(" ")}function O(e,t){var n=M(e);l(n,t),e.className=n.join(" ")}function I(e,t,r){((r=n(r)?!_(e,t):r)?L:O)(e,t)}function B(e,t){var r,o;if(n(t))return r=p((o=getComputedStyle(e)).paddingLeft)+p(o.paddingRight),o=p(o.borderLeftWidth)+p(o.borderRightWidth),e.offsetWidth-r-o;N(e,"width",t)}function H(e,t){var r,o;if(n(t))return r=p((o=getComputedStyle(e)).paddingTop)+p(o.paddingBottom),o=p(o.borderTopWidth)+p(o.borderBottomWidth),e.offsetHeight-r-o;N(e,"height",t)}function F(e,t,n){var o;r(window.CustomEvent)?o=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n}):(o=e.ownerDocument.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,n),e.dispatchEvent(o)}function z(e){return e.getClientRects().length}function P(e,t,n,r,o){for(e=o?e.lastChild:e.firstChild;e;){var i=o?e.previousSibling:e.nextSibling;if(!n&&!1===t(e)||!r&&!1===P(e,t,n,r,o)||n&&!1===t(e))return!1;e=i}}function j(e,t,n,r){P(e,t,n,r,!0)}function W(e,t){var n=(t=t||document).createDocumentFragment(),r=m("div",{},t);for(r.innerHTML=e;r.firstChild;)y(n,r.firstChild);return n}function U(e){return e&&(!D(e,"p,div")||e.className||C(e,"style")||!i(A(e)))}function G(e,t){var n=m(t,{},e.ownerDocument);for(s(e.attributes,(function(e,t){try{C(n,t.name,t.value)}catch(e){}}));e.firstChild;)y(n,e.firstChild);return e.parentNode.replaceChild(n,e),n}var q="|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|center|details|section|article|aside|nav|main|header|hgroup|footer|fieldset|dl|dt|dd|figure|figcaption|";function V(e){return!!/11?|9/.test(e.nodeType)&&"|iframe|area|base|basefont|br|col|frame|hr|img|input|wbr|isindex|link|meta|param|command|embed|keygen|source|track|object|".indexOf("|"+e.nodeName.toLowerCase()+"|")<0}function Y(e,t){var n=(e||{}).nodeType||d;return n!==u?n===d:"code"===(n=e.tagName.toLowerCase())?!t:q.indexOf("|"+n+"|")<0}function $(e){return e.lastChild&&$(e.lastChild)&&v(e.lastChild),3===e.nodeType?!e.nodeValue:V(e)&&!e.childNodes.length}function K(e){P(e,(function(e){var t=!Y(e,!0)&&e.nodeType!==f,n=e.parentNode;if(t&&(Y(n,!0)||"P"===n.tagName)){for(var r=e;Y(r.parentNode,!0)||"P"===r.parentNode.tagName;)r=r.parentNode;for(var o=Q(r,e),i=e;n&&Y(n,!0);){if(n.nodeType===u){for(var a=n.cloneNode();i.firstChild;)y(a,i.firstChild);y(i,a)}n=n.parentNode}R(i,r),$(o)||R(o,i),$(r)&&v(r)}t&&D(e,"ul,ol")&&D(e.parentNode,"ul,ol")&&(o="li",t=(t=e).previousElementSibling,(t=o&&t&&!D(t,o)?null:t)||R(t=m("li"),e),y(t,e))}))}function X(e,t){return e?(t?e.previousSibling:e.nextSibling)||X(e.parentNode,t):null}function Z(e){var t,n,r,o,i,a,l=N(e,"whiteSpace"),s=/line$/i.test(l),c=e.firstChild;if(!/pre(\-wrap)?$/i.test(l))for(;c;){if(i=c.nextSibling,t=c.nodeValue,(n=c.nodeType)===u&&c.firstChild&&Z(c),n===d){for(n=X(c),r=X(c,!0),a=!1;_(r,"sceditor-ignore");)r=X(r,!0);if(Y(c)&&r){for(o=r;o.lastChild;)for(o=o.lastChild;_(o,"sceditor-ignore");)o=X(o,!0);a=o.nodeType===d?/[\t\n\r ]$/.test(o.nodeValue):!Y(o)}t=t.replace(/\u200B/g,""),r&&Y(r)&&!a||(t=t.replace(s?/^[\t ]+/:/^[\t\n\r ]+/,"")),(t=n&&Y(n)?t:t.replace(s?/[\t ]+$/:/[\t\n\r ]+$/,"")).length?c.nodeValue=t.replace(s?/[\t ]+/g:/[\t\n\r ]+/g," "):v(c)}c=i}}function Q(e,t){var n=e.ownerDocument.createRange();return n.setStartBefore(e),n.setEndAfter(t),n.extractContents()}function J(e){for(var t=0,n=0;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:t,top:n}}function ee(e,t){var n=e.style;return c[t]||(c[t]=t.replace(/^-ms-/,"ms-").replace(/-(\w)/g,(function(e,t){return t.toUpperCase()}))),n=n[t=c[t]],"textAlign"===t&&(n=n||N(e,t),N(e.parentNode,t)===n||"block"!==N(e,"display")||D(e,"hr,th"))?"":n}function te(e,t){var n=e.attributes.length;if(n===t.attributes.length){for(;n--;){var r=e.attributes[n];if("style"===r.name?!function(e,t){var n=e.style.length;if(n===t.style.length){for(;n--;){var r=e.style[n];if(e.style[r]!==t.style[r])return}return 1}}(e,t):r.value!==C(t,r.name))return}return 1}}function ne(e){for(;e.firstChild;)R(e.firstChild,e);v(e)}var re={toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,pastetext|bulletlist,orderedlist,indent,outdent|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|ltr,rtl|print,maximize,source",toolbarExclude:null,style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:"#000000,#44B8FF,#1E92F7,#0074D9,#005DC2,#00369B,#b3d5f4|#444444,#C3FFFF,#9DF9FF,#7FDBFF,#68C4E8,#419DC1,#d9f4ff|#666666,#72FF84,#4CEA5E,#2ECC40,#17B529,#008E02,#c0f0c6|#888888,#FFFF44,#FFFA1E,#FFDC00,#E8C500,#C19E00,#fff5b3|#aaaaaa,#FFC95F,#FFA339,#FF851B,#E86E04,#C14700,#ffdbbb|#cccccc,#FF857A,#FF5F54,#FF4136,#E82A1F,#C10300,#ffc6c3|#eeeeee,#FF56FF,#FF30DC,#F012BE,#D900A7,#B20080,#fbb8ec|#ffffff,#F551FF,#CF2BE7,#B10DC9,#9A00B2,#9A00B2,#e8b6ef",locale:C(document.documentElement,"lang")||"en",charset:"utf-8",emoticonsCompat:!1,emoticonsEnabled:!0,emoticonsRoot:"",emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,resizeHeight:!0,resizeWidth:!0,dateFormat:"year-month-day",toolbarContainer:null,enablePasteFiltering:!1,disablePasting:!1,readOnly:!1,rtl:!1,autofocus:!1,autofocusEnd:!0,autoExpand:!1,autoUpdate:!1,spellcheck:!0,runWithoutWysiwygSupport:!1,startInSourceMode:!1,id:null,plugins:"",zIndex:null,bbcodeTrim:!1,disableBlockRemove:!1,allowedIframeUrls:[],parserOptions:{},dropDownCss:{},allowedTags:[],allowedAttributes:[]},oe=/^(https?|s?ftp|mailto|spotify|skype|ssh|teamspeak|tel):|(\/\/)|data:image\/(png|bmp|gif|p?jpe?g);/i;function ie(e){return e.replace(/([\-.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function ae(e,t){var n;return e&&(!(n={"&":"&amp;","<":"&lt;",">":"&gt;","  ":"&nbsp; ","\r\n":"<br />","\r":"<br />","\n":"<br />"})!==t&&(n['"']="&#34;",n["'"]="&#39;",n["`"]="&#96;"),e=e.replace(/ {2}|\r\n|[&<>\r\n'"`]/g,(function(e){return n[e]||e}))),e}var le={html:'<!DOCTYPE html><html{attrs}><head><meta http-equiv="Content-Type" content="text/html;charset={charset}" /><link rel="stylesheet" type="text/css" href="{style}" /></head><body contenteditable="true" {spellcheck}><p></p></body></html>',toolbarButton:'<a class="sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><div unselectable="on">{dispName}</div></a>',emoticon:'<img src="{url}" data-sceditor-emoticon="{key}" alt="{key}" title="{tooltip}" />',fontOpt:'<a class="sceditor-font-option" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',sizeOpt:'<a class="sceditor-fontsize-option" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',pastetext:'<div><label for="txt">{label}</label> <textarea cols="20" rows="7" id="txt"></textarea></div><div><input type="button" class="button" value="{insert}" /></div>',table:'<div><label for="rows">{rows}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{cols}</label><input type="text" id="cols" value="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',image:'<div><label for="image">{url}</label> <input type="text" id="image" dir="ltr" placeholder="https://" /></div><div><label for="width">{width}</label> <input type="text" id="width" size="2" dir="ltr" /></div><div><label for="height">{height}</label> <input type="text" id="height" size="2" dir="ltr" /></div><div><input type="button" class="button" value="{insert}" /></div>',email:'<div><label for="email">{label}</label> <input type="text" id="email" dir="ltr" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{insert}" /></div>',link:'<div><label for="link">{url}</label> <input type="text" id="link" dir="ltr" placeholder="https://" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{ins}" /></div>',youtubeMenu:'<div><label for="link">{label}</label> <input type="text" id="link" dir="ltr" placeholder="https://" /></div><div><input type="button" class="button" value="{insert}" /></div>',youtube:'<iframe width="560" height="315" frameborder="0" allowfullscreen src="https://www.youtube-nocookie.com/embed/{id}?wmode=opaque&start={time}" data-youtube-id="{id}"></iframe>'};function se(e,t,n){var r=le[e];return Object.keys(t).forEach((function(e){r=r.replace(new RegExp(ie("{"+e+"}"),"g"),t[e])})),r=n?W(r):r}function ce(e){if("mozHidden"in document)for(var t,n=e.getBody();n;){if((t=n).firstChild)t=t.firstChild;else{for(;t&&!t.nextSibling;)t=t.parentNode;t=t&&t.nextSibling}3!==n.nodeType||!/[\n\r\t]+/.test(n.nodeValue)||/^pre/.test(N(n.parentNode,"whiteSpace"))||v(n),n=t}}var ue={bold:{exec:"bold",tooltip:"Bold",shortcut:"Ctrl+B"},italic:{exec:"italic",tooltip:"Italic",shortcut:"Ctrl+I"},underline:{exec:"underline",tooltip:"Underline",shortcut:"Ctrl+U"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{state:function(e){var t;if(e=e&&3===e.nodeType?e.parentNode:e)return t="ltr"===N(e,"direction"),e=N(e,"textAlign"),/left/.test(e)||e===(t?"start":"end")},exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{state:function(e){var t;if(e=e&&3===e.nodeType?e.parentNode:e)return t="ltr"===N(e,"direction"),e=N(e,"textAlign"),/right/.test(e)||e===(t?"end":"start")},exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{_dropDown:function(e,t,n){var r=m("div");x(r,"click","a",(function(t){n(A(this,"font")),e.closeDropDown(!0),t.preventDefault()})),e.opts.fonts.split(",").forEach((function(e){y(r,se("fontOpt",{font:e},!0))})),e.createDropDown(t,"font-picker",r)},exec:function(e){var t=this;ue.font._dropDown(t,e,(function(e){t.execCommand("fontname",e)}))},tooltip:"Font Name"},size:{_dropDown:function(e,t,n){var r=m("div");x(r,"click","a",(function(t){n(A(this,"size")),e.closeDropDown(!0),t.preventDefault()}));for(var o=1;o<=7;o++)y(r,se("sizeOpt",{size:o},!0));e.createDropDown(t,"fontsize-picker",r)},exec:function(e){var t=this;ue.size._dropDown(t,e,(function(e){t.execCommand("fontsize",e)}))},tooltip:"Font Size"},color:{_dropDown:function(e,t,n){var r=m("div"),o="",i=ue.color;i._htmlCache||(e.opts.colors.split("|").forEach((function(e){o+='<div class="sceditor-color-column">',e.split(",").forEach((function(e){o+='<a href="#" class="sceditor-color-option" style="background-color: '+e+'" data-color="'+e+'"></a>'})),o+="</div>"})),i._htmlCache=o),y(r,W(i._htmlCache)),x(r,"click","a",(function(t){n(A(this,"color")),e.closeDropDown(!0),t.preventDefault()})),e.createDropDown(t,"color-picker",r)},exec:function(e){var t=this;ue.color._dropDown(t,e,(function(e){t.execCommand("forecolor",e)}))},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(e){var t,n=m("div"),r=this;y(n,se("pastetext",{label:r._("Paste your text inside the following box:"),insert:r._("Insert")},!0)),x(n,"click",".button",(function(e){(t=b(n,"#txt")[0].value)&&r.wysiwygEditorInsertText(t),r.closeDropDown(!0),e.preventDefault()})),r.createDropDown(e,"pastetext",n)},tooltip:"Paste Text"},bulletlist:{exec:function(){ce(this),this.execCommand("insertunorderedlist")},tooltip:"Bullet list"},orderedlist:{exec:function(){ce(this),this.execCommand("insertorderedlist")},tooltip:"Numbered list"},indent:{state:function(e,t){var n;return D(t,"li")||D(t,"ul,ol,menu")&&(n=(t=this.getRangeHelper().selectedRange()).startContainer.parentNode,t=t.endContainer.parentNode,n!==n.parentNode.firstElementChild||D(t,"li")&&t!==t.parentNode.lastElementChild)?0:-1},exec:function(){var e=this.getRangeHelper().getFirstBlockParent();this.focus(),g(e,"ul,ol,menu")&&this.execCommand("indent")},tooltip:"Add indent"},outdent:{state:function(e,t){return g(t,"ul,ol,menu")?0:-1},exec:function(){g(this.getRangeHelper().getFirstBlockParent(),"ul,ol,menu")&&this.execCommand("outdent")},tooltip:"Remove one indent"},table:{exec:function(e){var t=this,n=m("div");y(n,se("table",{rows:t._("Rows:"),cols:t._("Cols:"),insert:t._("Insert")},!0)),x(n,"click",".button",(function(e){var r=Number(b(n,"#rows")[0].value),o=Number(b(n,"#cols")[0].value),i="<table>";0<r&&0<o&&(i+=Array(r+1).join("<tr>"+Array(o+1).join("<td><br /></td>")+"</tr>"),t.wysiwygEditorInsertHtml(i+="</table>"),t.closeDropDown(!0),e.preventDefault())})),t.createDropDown(e,"inserttable",n)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{exec:function(){this.wysiwygEditorInsertHtml("<code>","<br /></code>")},tooltip:"Code"},image:{_dropDown:function(e,t,n,r){var o=m("div"),i=(y(o,se("image",{url:e._("URL:"),width:e._("Width (optional):"),height:e._("Height (optional):"),insert:e._("Insert")},!0)),b(o,"#image")[0]);i.value=n,x(o,"click",".button",(function(t){i.value&&r(i.value,b(o,"#width")[0].value,b(o,"#height")[0].value),e.closeDropDown(!0),t.preventDefault()})),e.createDropDown(t,"insertimage",o)},exec:function(e){var t=this;ue.image._dropDown(t,e,"",(function(e,n,r){var o="";n&&(o+=' width="'+parseInt(n,10)+'"'),r&&(o+=' height="'+parseInt(r,10)+'"'),o+=' src="'+ae(e)+'"',t.wysiwygEditorInsertHtml("<img"+o+" />")}))},tooltip:"Insert an image"},email:{_dropDown:function(e,t,n){var r=m("div");y(r,se("email",{label:e._("E-mail:"),desc:e._("Description (optional):"),insert:e._("Insert")},!0)),x(r,"click",".button",(function(t){var o=b(r,"#email")[0].value;o&&n(o,b(r,"#des")[0].value),e.closeDropDown(!0),t.preventDefault()})),e.createDropDown(t,"insertemail",r)},exec:function(e){var t=this;ue.email._dropDown(t,e,(function(e,n){!t.getRangeHelper().selectedHtml()||n?t.wysiwygEditorInsertHtml('<a href="mailto:'+ae(e)+'">'+ae(n||e)+"</a>"):t.execCommand("createlink","mailto:"+e)}))},tooltip:"Insert an email"},link:{_dropDown:function(e,t,n){var r=m("div"),o=(y(r,se("link",{url:e._("URL:"),desc:e._("Description (optional):"),ins:e._("Insert")},!0)),b(r,"#link")[0]);function i(t){o.value&&n(o.value,b(r,"#des")[0].value),e.closeDropDown(!0),t.preventDefault()}x(r,"click",".button",i),x(r,"keypress",(function(e){13===e.which&&o.value&&i(e)}),!0),e.createDropDown(t,"insertlink",r)},exec:function(e){var t=this;ue.link._dropDown(t,e,(function(e,n){n||!t.getRangeHelper().selectedHtml()?t.wysiwygEditorInsertHtml('<a href="'+ae(e)+'">'+ae(n||e)+"</a>"):t.execCommand("createlink",e)}))},tooltip:"Insert a link"},unlink:{state:function(){return g(this.currentNode(),"a")?0:-1},exec:function(){var e=g(this.currentNode(),"a");if(e){for(;e.firstChild;)R(e.firstChild,e);v(e)}},tooltip:"Unlink"},quote:{exec:function(e,t,n){var r="<blockquote>",o="</blockquote>";t?(r=r+(n=n?"<cite>"+ae(n)+"</cite>":"")+t+o,o=null):""===this.getRangeHelper().selectedHtml()&&(o="<br />"+o),this.wysiwygEditorInsertHtml(r,o)},tooltip:"Insert a Quote"},emoticon:{exec:function(e){var t=this;t.createDropDown(e,"emoticons",function n(r){var o,i=t.opts,l=i.emoticonsRoot||"",c=i.emoticonsCompat,u=t.getRangeHelper(),d=c&&" "!==u.getOuterText(!0,1)?" ":"",f=c&&" "!==u.getOuterText(!1,1)?" ":"",p=m("div"),h=m("div");return c=a({},i.emoticons.dropdown,r?i.emoticons.more:{}),y(p,h),o=Math.sqrt(Object.keys(c).length),x(p,"click","img",(function(e){t.insert(d+C(this,"alt")+f,null,!1).closeDropDown(!0),e.preventDefault()})),s(c,(function(e,t){y(h,m("img",{src:l+(t.url||t),alt:e,title:t.tooltip||e})),h.children.length>=o&&(h=m("div"),y(p,h))})),!r&&i.emoticons.more&&(y(u=m("a",{className:"sceditor-more"}),document.createTextNode(t._("More"))),x(u,"click",(function(r){t.createDropDown(e,"more-emoticons",n(!0)),r.preventDefault()})),y(p,u)),p}(!1))},txtExec:function(e){ue.emoticon.exec.call(this,e)},tooltip:"Insert an emoticon"},youtube:{_dropDown:function(e,t,n){var r=m("div");y(r,se("youtubeMenu",{label:e._("Video URL:"),insert:e._("Insert")},!0)),x(r,"click",".button",(function(t){var o=(i=b(r,"#link")[0].value).match(/(?:v=|v\/|embed\/|youtu.be\/)?([a-zA-Z0-9_-]{11})/),i=i.match(/[&|?](?:star)?t=((\d+[hms]?){1,3})/),a=0;i&&s(i[1].split(/[hms]/),(function(e,t){""!==t&&(a=60*a+Number(t))})),o&&/^[a-zA-Z0-9_\-]{11}$/.test(o[1])&&n(o[1],a),e.closeDropDown(!0),t.preventDefault()})),e.createDropDown(t,"insertlink",r)},exec:function(e){var t=this;ue.youtube._dropDown(t,e,(function(e,n){t.wysiwygEditorInsertHtml(se("youtube",{id:e,time:n}))}))},tooltip:"Insert a YouTube video"},date:{_date:function(e){var t,n=(t=new Date).getYear(),r=t.getMonth()+1;return r<10&&(r="0"+r),(t=t.getDate())<10&&(t="0"+t),e.opts.dateFormat.replace(/year/i,n=n<2e3?1900+n:n).replace(/month/i,r).replace(/day/i,t)},exec:function(){this.insertText(ue.date._date(this))},txtExec:function(){this.insertText(ue.date._date(this))},tooltip:"Insert current date"},time:{_time:function(){var e,t=(e=new Date).getHours(),n=e.getMinutes();return(t=t<10?"0"+t:t)+":"+(n=n<10?"0"+n:n)+":"+((e=e.getSeconds())<10?"0"+e:e)},exec:function(){this.insertText(ue.time._time())},txtExec:function(){this.insertText(ue.time._time())},tooltip:"Insert current time"},ltr:{state:function(e,t){return t&&"ltr"===t.style.direction},exec:function(){var e=this.getRangeHelper(),t=e.getFirstBlockParent();this.focus(),(t&&!D(t,"body")||(this.execCommand("formatBlock","p"),(t=e.getFirstBlockParent())&&!D(t,"body")))&&(e="ltr"===N(t,"direction")?"":"ltr",N(t,"direction",e))},tooltip:"Left-to-Right"},rtl:{state:function(e,t){return t&&"rtl"===t.style.direction},exec:function(){var e=this.getRangeHelper(),t=e.getFirstBlockParent();this.focus(),(t&&!D(t,"body")||(this.execCommand("formatBlock","p"),(t=e.getFirstBlockParent())&&!D(t,"body")))&&(e="rtl"===N(t,"direction")?"":"rtl",N(t,"direction",e))},tooltip:"Right-to-Left"},print:{exec:"print",tooltip:"Print"},maximize:{state:function(){return this.maximize()},exec:function(){this.maximize(!this.maximize()),this.focus()},txtExec:function(){this.maximize(!this.maximize()),this.focus()},tooltip:"Maximize",shortcut:"Ctrl+Shift+M"},source:{state:function(){return this.sourceMode()},exec:function(){this.toggleSourceMode(),this.focus()},txtExec:function(){this.toggleSourceMode(),this.focus()},tooltip:"View source",shortcut:"Ctrl+Shift+S"},ignore:{}},de={};function fe(e){function t(e){return"signal"+e.charAt(0).toUpperCase()+e.slice(1)}function n(n,r){for(var i,a=t((n=[].slice.call(n)).shift()),l=0;l<o.length;l++)if(a in o[l]&&(i=o[l][a].apply(e,n),r))return i}var r=this,o=[];r.call=function(){n(arguments,!1)},r.callOnlyFirst=function(){return n(arguments,!0)},r.hasHandler=function(e){var n=o.length;for(e=t(e);n--;)if(e in o[n])return!0;return!1},r.exists=function(e){return e in de&&"function"==typeof(e=de[e])&&"object"==typeof e.prototype},r.isRegistered=function(e){if(r.exists(e))for(var t=o.length;t--;)if(o[t]instanceof de[e])return!0;return!1},r.register=function(t){return!(!r.exists(t)||r.isRegistered(t)||(t=new de[t],o.push(t),"init"in t&&t.init.call(e),0))},r.deregister=function(t){var n,i=o.length,a=!1;if(r.isRegistered(t))for(;i--;)o[i]instanceof de[t]&&(a=!0,"destroy"in(n=o.splice(i,1)[0])&&n.destroy.call(e));return a},r.destroy=function(){for(var t=o.length;t--;)"destroy"in o[t]&&o[t].destroy.call(e);o=[],e=null}}fe.plugins=de;var pe=function(e,t,n){var r,o,i,a,l,s="",c=e.startContainer,u=e.startOffset;for(c&&3!==c.nodeType&&(c=c.childNodes[u],u=0),i=a=u;n>s.length&&c&&3===c.nodeType;)r=c.nodeValue,o=n-s.length,l&&(a=r.length,i=0),l=c,c=t?(u=i=Math.max(a-o,0),s=r.substr(i,a-i)+s,l.previousSibling):(u=i+(a=Math.min(o,r.length)),s+=r.substr(i,a),l.nextSibling);return{node:l||c,offset:u,text:s}};function me(e,t,n){var r,o,i=t||e.contentDocument||e.document,a="sceditor-start-marker",l="sceditor-end-marker",c=this;c.insertHTML=function(e,t){var r,o;if(!c.selectedRange())return!1;for(t&&(e+=c.selectedHtml()+t),o=m("p",{},i),r=i.createDocumentFragment(),o.innerHTML=n(e);o.firstChild;)y(r,o.firstChild);c.insertNode(r)},o=function(e,t,n){var o,s=i.createDocumentFragment();if("string"==typeof e?(t&&(e+=c.selectedHtml()+t),s=W(e)):(y(s,e),t&&(y(s,c.selectedRange().extractContents()),y(s,t))),o=s.lastChild){for(;!Y(o.lastChild,!0);)o=o.lastChild;return V(o)?o.lastChild||y(o,document.createTextNode("​")):o=s,c.removeMarkers(),y(o,r(a)),y(o,r(l)),n?(y(e=m("div"),s),e.innerHTML):s}},c.insertNode=function(e,t){e=o(e,t);var n,r,i=(t=c.selectedRange()).commonAncestorContainer,a=[];if(!e)return!1;function l(e){e&&$(e)&&a.indexOf(e)<0&&v(e)}t.startContainer!==t.endContainer&&(s(i.childNodes,(function(e,t){$(t)&&a.push(t)})),n=e.firstChild,r=e.lastChild),t.deleteContents(),i&&3!==i.nodeType&&!V(i)?R(e,i):(t.insertNode(e),l(n&&n.previousSibling),l(r&&r.nextSibling)),c.restoreRange()},c.cloneSelected=function(){var e=c.selectedRange();if(e)return e.cloneRange()},c.selectedRange=function(){var t,n,r=e.getSelection();if(r){if(r.rangeCount<=0){for(n=i.body;n.firstChild;)n=n.firstChild;(t=i.createRange()).setStartBefore(n),r.addRange(t)}return 0<r.rangeCount?r.getRangeAt(0):t}},c.hasSelection=function(){var t=e.getSelection();return t&&0<t.rangeCount},c.selectedHtml=function(){var e,t=c.selectedRange();return t?(y(e=m("p",{},i),t.cloneContents()),e.innerHTML):""},c.parentNode=function(){var e=c.selectedRange();if(e)return e.commonAncestorContainer},c.getFirstBlockParent=function(e){var t=function(e){return Y(e,!0)?(e=e?e.parentNode:null)&&t(e):e};return t(e||c.parentNode())},c.insertNodeAt=function(e,t){var n=c.selectedRange(),r=c.cloneSelected();if(!r)return!1;r.collapse(e),r.insertNode(t),c.selectRange(n)},r=function(e){return c.removeMarker(e),(e=m("span",{id:e,className:"sceditor-selection sceditor-ignore",style:"display:none;line-height:0"},i)).innerHTML=" ",e},c.insertMarkers=function(){var e=c.selectedRange(),t=r(a);c.removeMarkers(),c.insertNodeAt(!0,t),e&&e.collapsed?t.parentNode.insertBefore(r(l),t.nextSibling):c.insertNodeAt(!1,r(l))},c.getMarker=function(e){return i.getElementById(e)},c.removeMarker=function(e){(e=c.getMarker(e))&&v(e)},c.removeMarkers=function(){c.removeMarker(a),c.removeMarker(l)},c.saveRange=function(){c.insertMarkers()},c.selectRange=function(t){var n,r=e.getSelection(),o=t.endContainer;if(t.collapsed&&o&&!Y(o,!0)){for(n=o.lastChild;n&&D(n,".sceditor-ignore");)n=n.previousSibling;D(n,"br")&&((o=i.createRange()).setEndAfter(n),o.collapse(!1),c.compare(t,o)&&(t.setStartBefore(n),t.collapse(!0)))}r&&(c.clear(),r.addRange(t))},c.restoreRange=function(){var e,t=c.selectedRange(),n=c.getMarker(a),r=c.getMarker(l);if(!n||!r||!t)return!1;e=n.nextSibling===r,(t=i.createRange()).setStartBefore(n),t.setEndAfter(r),e&&t.collapse(!0),c.selectRange(t),c.removeMarkers()},c.selectOuterText=function(e,t){var n=c.cloneSelected();if(!n)return!1;n.collapse(!1),e=pe(n,!0,e),t=pe(n,!1,t),n.setStart(e.node,e.offset),n.setEnd(t.node,t.offset),c.selectRange(n)},c.getOuterText=function(e,t){var n=c.cloneSelected();return n?(n.collapse(!e),pe(n,e,t).text):""},c.replaceKeyword=function(e,t,n,r,o,i){n||e.sort((function(e,t){return e[0].length-t[0].length}));var a,l,s,u,d,f,p,m="(^|[\\s    ])",h=e.length,g=o?1:0;for(n=r||e[h-1][0].length,o&&n++,i=i||"",u=(a=c.getOuterText(!0,n)).length,a+=i,t&&(a+=c.getOuterText(!1,n));h--;)if(p=(f=e[h][0]).length,s=Math.max(0,u-p-g),l=-1,o?(d=a.substr(s).match(new RegExp(m+ie(f)+m)))&&(l=d.index+s+d[1].length):l=a.indexOf(f,s),-1<l&&l<=u&&u<=l+p+g)return c.selectOuterText(d=u-l,p-d-(/^\S/.test(i)?1:0)),c.insertHTML(e[h][1]),!0;return!1},c.compare=function(e,t){return t=t||c.selectedRange(),e&&t?0===e.compareBoundaryPoints(Range.END_TO_END,t)&&0===e.compareBoundaryPoints(Range.START_TO_START,t):!e&&!t},c.clear=function(){var t=e.getSelection();t&&(t.removeAllRanges?t.removeAllRanges():t.empty&&t.empty())}}var he,ge,ve,ye=navigator.userAgent,be=/iPhone|iPod|iPad| wosbrowser\//i.test(ye),xe=(he=!!window.document.documentMode,ge="-ms-ime-align"in document.documentElement.style,(ve=document.createElement("div")).contentEditable=!0,"contentEditable"in document.documentElement&&"true"===ve.contentEditable&&(ve=/Opera Mobi|Opera Mini/i.test(ye),/Android/i.test(ye)&&(ve=!0,/Safari/.test(ye)&&(ve=!(Le=/Safari\/(\d+)/.exec(ye))||!Le[1]||Le[1]<534)),/ Silk\//i.test(ye)&&(ve=!(Le=/AppleWebKit\/(\d+)/.exec(ye))||!Le[1]||Le[1]<534),be&&(ve=/OS [0-4](_\d)+ like Mac/i.test(ye)),/Firefox/i.test(ye)&&(ve=!1),/OneBrowser/i.test(ye)&&(ve=!1),"UCWEB"===navigator.vendor&&(ve=!1),!(ve=!(!he&&!ge)||ve)));function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e,t,n){return(Ee=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),1}catch(e){}}}()?Reflect.construct:function(e,t,n){var r=[null];return r.push.apply(r,t),t=new(Function.bind.apply(e,r)),n&&Ce(t,n.prototype),t}).apply(null,arguments)}function Te(e){return function(e){if(Array.isArray(e))return Se(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var n;if(e)return"string"==typeof e?Se(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Se(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ke,Ne=Object.hasOwnProperty,Ae=Object.setPrototypeOf,De=Object.isFrozen,Re=Object.getPrototypeOf,Me=Object.getOwnPropertyDescriptor,_e=Object.freeze,Le=Object.seal,Oe=Object.create,Ie=(ye="undefined"!=typeof Reflect&&Reflect,(Ie=ye.apply)||function(e,t,n){return e.apply(t,n)}),Be=(_e=_e||function(e){return e},Le=Le||function(e){return e},(Be=ye.construct)||function(e,t){return Ee(e,Te(t))}),He=$e(Array.prototype.forEach),Fe=$e(Array.prototype.pop),ze=$e(Array.prototype.push),Pe=$e(String.prototype.toLowerCase),je=$e(String.prototype.toString),We=$e(String.prototype.match),Ue=$e(String.prototype.replace),Ge=$e(String.prototype.indexOf),qe=$e(String.prototype.trim),Ve=$e(RegExp.prototype.test),Ye=(ke=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Be(ke,t)});function $e(e){return function(t){for(var n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return Ie(e,t,r)}}function Ke(e,t,n){n=n||Pe,Ae&&Ae(e,null);for(var r=t.length;r--;){var o,i=t[r];"string"!=typeof i||(o=n(i))!==i&&(De(t)||(t[r]=o),i=o),e[i]=!0}return e}function Xe(e){var t,n=Oe(null);for(t in e)!0===Ie(Ne,e,[t])&&(n[t]=e[t]);return n}function Ze(e,t){for(;null!==e;){var n=Me(e,t);if(n){if(n.get)return $e(n.get);if("function"==typeof n.value)return $e(n.value)}e=Re(e)}return function(e){return console.warn("fallback value for",e),null}}var Qe=_e(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Je=_e(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),et=_e(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),tt=_e(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),nt=_e(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),rt=_e(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ot=_e(["#text"]),it=_e(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),at=_e(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),lt=_e(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),st=_e(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ct=Le(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ut=Le(/<%[\w\W]*|[\w\W]*%>/gm),dt=Le(/\${[\w\W]*}/gm),ft=Le(/^data-[\-\w.\u00B7-\uFFFF]/),pt=Le(/^aria-[\-\w]+$/),mt=Le(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ht=Le(/^(?:\w+script|data):/i),gt=Le(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),vt=Le(/^html$/i),yt=function e(t){var n=0<arguments.length&&void 0!==t?t:"undefined"==typeof window?null:window,r=function(t){return e(t)};if(r.version="2.4.3",r.removed=[],n&&n.document&&9===n.document.nodeType){var o=n.document,i=n.document,a=n.DocumentFragment,l=(t=n.HTMLTemplateElement,n.Node),s=n.Element,c=n.NodeFilter,u=void 0===(S=n.NamedNodeMap)?n.NamedNodeMap||n.MozNamedAttrMap:S,d=n.HTMLFormElement,f=n.DOMParser,p=n.trustedTypes,m=Ze(S=s.prototype,"cloneNode"),h=Ze(S,"nextSibling"),g=Ze(S,"childNodes"),v=Ze(S,"parentNode"),y=("function"==typeof t&&(S=i.createElement("template")).content&&S.content.ownerDocument&&(i=S.content.ownerDocument),function(e,t){if("object"!==we(e)||"function"!=typeof e.createPolicy)return null;var n=null,r="data-tt-policy-suffix";t="dompurify"+((n=t.currentScript&&t.currentScript.hasAttribute(r)?t.currentScript.getAttribute(r):n)?"#"+n:"");try{return e.createPolicy(t,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+t+" could not be created."),null}}(p,o)),b=y?y.createHTML(""):"",x=(t=i).implementation,w=t.createNodeIterator,C=t.createDocumentFragment,E=t.getElementsByTagName,T=o.importNode,S={};try{S=Xe(i).documentMode?i.documentMode:{}}catch(t){}var k,N,A,D={},R=(r.isSupported="function"==typeof v&&x&&void 0!==x.createHTMLDocument&&9!==S,ct),M=ut,_=dt,L=ft,O=pt,I=ht,B=gt,H=mt,F=null,z=Ke({},[].concat(Te(Qe),Te(Je),Te(et),Te(nt),Te(ot))),P=null,j=Ke({},[].concat(Te(it),Te(at),Te(lt),Te(st))),W=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),U=null,G=null,q=!0,V=!0,Y=!1,$=!1,K=!1,X=!1,Z=!1,Q=!1,J=!1,ee=!1,te=!0,ne=!1,re=!0,oe=!1,ie={},ae=null,le=Ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),se=null,ce=Ke({},["audio","video","img","source","image","track"]),ue=null,de=Ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),fe="http://www.w3.org/1998/Math/MathML",pe="http://www.w3.org/2000/svg",me="http://www.w3.org/1999/xhtml",he=me,ge=null,ve=Ke({},[fe,pe,me],je),ye=["application/xhtml+xml","text/html"],be=null,xe=i.createElement("form"),Ce=function(e){return e instanceof RegExp||e instanceof Function},Ee=function(e){be&&be===e||(e=Xe(e=e&&"object"===we(e)?e:{}),N=N=-1===ye.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,A="application/xhtml+xml"===N?je:Pe,F="ALLOWED_TAGS"in e?Ke({},e.ALLOWED_TAGS,A):z,P="ALLOWED_ATTR"in e?Ke({},e.ALLOWED_ATTR,A):j,ge="ALLOWED_NAMESPACES"in e?Ke({},e.ALLOWED_NAMESPACES,je):ve,ue="ADD_URI_SAFE_ATTR"in e?Ke(Xe(de),e.ADD_URI_SAFE_ATTR,A):de,se="ADD_DATA_URI_TAGS"in e?Ke(Xe(ce),e.ADD_DATA_URI_TAGS,A):ce,ae="FORBID_CONTENTS"in e?Ke({},e.FORBID_CONTENTS,A):le,U="FORBID_TAGS"in e?Ke({},e.FORBID_TAGS,A):{},G="FORBID_ATTR"in e?Ke({},e.FORBID_ATTR,A):{},ie="USE_PROFILES"in e&&e.USE_PROFILES,q=!1!==e.ALLOW_ARIA_ATTR,V=!1!==e.ALLOW_DATA_ATTR,Y=e.ALLOW_UNKNOWN_PROTOCOLS||!1,$=e.SAFE_FOR_TEMPLATES||!1,K=e.WHOLE_DOCUMENT||!1,Q=e.RETURN_DOM||!1,J=e.RETURN_DOM_FRAGMENT||!1,ee=e.RETURN_TRUSTED_TYPE||!1,Z=e.FORCE_BODY||!1,te=!1!==e.SANITIZE_DOM,ne=e.SANITIZE_NAMED_PROPS||!1,re=!1!==e.KEEP_CONTENT,oe=e.IN_PLACE||!1,H=e.ALLOWED_URI_REGEXP||H,he=e.NAMESPACE||me,e.CUSTOM_ELEMENT_HANDLING&&Ce(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Ce(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(W.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),$&&(V=!1),J&&(Q=!0),ie&&(F=Ke({},Te(ot)),P=[],!0===ie.html&&(Ke(F,Qe),Ke(P,it)),!0===ie.svg&&(Ke(F,Je),Ke(P,at),Ke(P,st)),!0===ie.svgFilters&&(Ke(F,et),Ke(P,at),Ke(P,st)),!0===ie.mathMl&&(Ke(F,nt),Ke(P,lt),Ke(P,st))),e.ADD_TAGS&&Ke(F=F===z?Xe(F):F,e.ADD_TAGS,A),e.ADD_ATTR&&Ke(P=P===j?Xe(P):P,e.ADD_ATTR,A),e.ADD_URI_SAFE_ATTR&&Ke(ue,e.ADD_URI_SAFE_ATTR,A),e.FORBID_CONTENTS&&Ke(ae=ae===le?Xe(ae):ae,e.FORBID_CONTENTS,A),re&&(F["#text"]=!0),K&&Ke(F,["html","head","body"]),F.table&&(Ke(F,["tbody"]),delete U.tbody),_e&&_e(e),be=e)},Se=Ke({},["mi","mo","mn","ms","mtext"]),ke=Ke({},["foreignobject","desc","title","annotation-xml"]),Ne=Ke({},["title","style","font","a","script"]),Ae=Ke({},Je),De=(Ke(Ae,et),Ke(Ae,tt),Ke({},nt)),Re=(Ke(De,rt),function(e){ze(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=b}catch(t){e.remove()}}}),Me=function(e,t){try{ze(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){ze(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!P[e])if(Q||J)try{Re(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Le=function(e){Z?e="<remove></remove>"+e:n=(n=We(e,/^[\r\n\t ]+/))&&n[0],"application/xhtml+xml"===N&&he===me&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var t,n,r=y?y.createHTML(e):e;if(he===me)try{t=(new f).parseFromString(r,N)}catch(e){}if(!t||!t.documentElement){t=x.createDocument(he,"template",null);try{t.documentElement.innerHTML=k?b:r}catch(e){}}return r=t.body||t.documentElement,e&&n&&r.insertBefore(i.createTextNode(n),r.childNodes[0]||null),he===me?E.call(t,K?"html":"body")[0]:K?t.documentElement:r},Oe=function(e){return w.call(e.ownerDocument||e,e,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},Ie=function(e){return"object"===we(l)?e instanceof l:e&&"object"===we(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Be=function(e,t,n){D[e]&&He(D[e],(function(e){e.call(r,t,n,be)}))},$e=function(e){if(Be("beforeSanitizeElements",e,null),(!((a=e)instanceof d)||"string"==typeof a.nodeName&&"string"==typeof a.textContent&&"function"==typeof a.removeChild&&a.attributes instanceof u&&"function"==typeof a.removeAttribute&&"function"==typeof a.setAttribute&&"string"==typeof a.namespaceURI&&"function"==typeof a.insertBefore&&"function"==typeof a.hasChildNodes)&&!Ve(/[\u0080-\uFFFF]/,e.nodeName)){var t,n,o,i,a=A(e.nodeName);if(Be("uponSanitizeElement",e,{tagName:a,allowedTags:F}),(!e.hasChildNodes()||Ie(e.firstElementChild)||Ie(e.content)&&Ie(e.content.firstElementChild)||!Ve(/<[/\w]/g,e.innerHTML)||!Ve(/<[/\w]/g,e.textContent))&&("select"!==a||!Ve(/<template/i,e.innerHTML))){if(F[a]&&!U[a])return e instanceof s&&((n=v(t=e))&&n.tagName||(n={namespaceURI:he,tagName:"template"}),o=Pe(t.tagName),i=Pe(n.tagName),!ge[t.namespaceURI]||(t.namespaceURI===pe?n.namespaceURI===me?"svg"!==o:n.namespaceURI===fe?"svg"!==o||"annotation-xml"!==i&&!Se[i]:!Boolean(Ae[o]):t.namespaceURI===fe?n.namespaceURI===me?"math"!==o:n.namespaceURI===pe?"math"!==o||!ke[i]:!Boolean(De[o]):t.namespaceURI===me?n.namespaceURI===pe&&!ke[i]||n.namespaceURI===fe&&!Se[i]||De[o]||!Ne[o]&&Ae[o]:"application/xhtml+xml"!==N||!ge[t.namespaceURI]))||("noscript"===a||"noembed"===a)&&Ve(/<\/no(script|embed)/i,e.innerHTML)?(Re(e),!0):($&&3===e.nodeType&&(n=e.textContent,n=Ue(n,R," "),n=Ue(n,M," "),n=Ue(n,_," "),e.textContent!==n&&(ze(r.removed,{element:e.cloneNode()}),e.textContent=n)),Be("afterSanitizeElements",e,null),!1);if(!U[a]&&bt(a)){if(W.tagNameCheck instanceof RegExp&&Ve(W.tagNameCheck,a))return!1;if(W.tagNameCheck instanceof Function&&W.tagNameCheck(a))return!1}if(re&&!ae[a]){var l=v(e)||e.parentNode,c=g(e)||e.childNodes;if(c&&l)for(var f=c.length-1;0<=f;--f)l.insertBefore(m(c[f],!0),h(e))}}}return Re(e),!0},yt=function(e,t,n){if(te&&("id"===t||"name"===t)&&(n in i||n in xe))return!1;if((!V||G[t]||!Ve(L,t))&&(!q||!Ve(O,t)))if(!P[t]||G[t]){if(!(bt(e)&&(W.tagNameCheck instanceof RegExp&&Ve(W.tagNameCheck,e)||W.tagNameCheck instanceof Function&&W.tagNameCheck(e))&&(W.attributeNameCheck instanceof RegExp&&Ve(W.attributeNameCheck,t)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(t))||"is"===t&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&Ve(W.tagNameCheck,n)||W.tagNameCheck instanceof Function&&W.tagNameCheck(n))))return!1}else if(!ue[t]&&!Ve(H,Ue(n,B,""))&&("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Ge(n,"data:")||!se[e])&&(!Y||Ve(I,Ue(n,B,"")))&&n)return!1;return!0},bt=function(e){return 0<e.indexOf("-")},xt=function(e){Be("beforeSanitizeAttributes",e,null);var t=e.attributes;if(t){for(var n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:P},o=t.length;o--;){var i=(s=t[o]).name,a=s.namespaceURI,l="value"===i?s.value:qe(s.value),s=A(i);if(n.attrName=s,n.attrValue=l,n.keepAttr=!0,n.forceKeepAttr=void 0,Be("uponSanitizeAttribute",e,n),l=n.attrValue,!n.forceKeepAttr&&(Me(i,e),n.keepAttr))if(Ve(/\/>/i,l))Me(i,e);else{$&&(l=Ue(l,R," "),l=Ue(l,M," "),l=Ue(l,_," "));var c=A(e.nodeName);if(yt(c,s,l)){if(!ne||"id"!==s&&"name"!==s||(Me(i,e),l="user-content-"+l),y&&"object"===we(p)&&"function"==typeof p.getAttributeType&&!a)switch(p.getAttributeType(c,s)){case"TrustedHTML":l=y.createHTML(l);break;case"TrustedScriptURL":l=y.createScriptURL(l)}try{a?e.setAttributeNS(a,i,l):e.setAttribute(i,l),Fe(r.removed)}catch(e){}}}}Be("afterSanitizeAttributes",e,null)}},wt=function e(t){var n,r=Oe(t);for(Be("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)Be("uponSanitizeShadowNode",n,null),$e(n)||(n.content instanceof a&&e(n.content),xt(n));Be("afterSanitizeShadowDOM",t,null)};r.sanitize=function(e){var t,i,s,c,u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof(e=(k=!e)?"\x3c!--\x3e":e)&&!Ie(e)){if("function"!=typeof e.toString)throw Ye("toString is not a function");if("string"!=typeof(e=e.toString()))throw Ye("dirty is not a string, aborting")}if(!r.isSupported){if("object"===we(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof e)return n.toStaticHTML(e);if(Ie(e))return n.toStaticHTML(e.outerHTML)}return e}if(X||Ee(u),r.removed=[],oe="string"!=typeof e&&oe){if(e.nodeName&&(u=A(e.nodeName),!F[u]||U[u]))throw Ye("root node is forbidden and cannot be sanitized in-place")}else if(e instanceof l)1===(u=(t=Le("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===u.nodeName||"HTML"===u.nodeName?t=u:t.appendChild(u);else{if(!Q&&!$&&!K&&-1===e.indexOf("<"))return y&&ee?y.createHTML(e):e;if(!(t=Le(e)))return Q?null:ee?b:""}t&&Z&&Re(t.firstChild);for(var d=Oe(oe?e:t);i=d.nextNode();)3===i.nodeType&&i===s||$e(i)||(i.content instanceof a&&wt(i.content),xt(i),s=i);if(s=null,oe)return e;if(Q){if(J)for(c=C.call(t.ownerDocument);t.firstChild;)c.appendChild(t.firstChild);else c=t;return P.shadowroot?T.call(o,c,!0):c}return u=K?t.outerHTML:t.innerHTML,K&&F["!doctype"]&&t.ownerDocument&&t.ownerDocument.doctype&&t.ownerDocument.doctype.name&&Ve(vt,t.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+t.ownerDocument.doctype.name+">\n"+u),$&&(u=Ue(u,R," "),u=Ue(u,M," "),u=Ue(u,_," ")),y&&ee?y.createHTML(u):u},r.setConfig=function(e){Ee(e),X=!0},r.clearConfig=function(){be=null,X=!1},r.isValidAttribute=function(e,t,n){return be||Ee({}),e=A(e),t=A(t),yt(e,t,n)},r.addHook=function(e,t){"function"==typeof t&&(D[e]=D[e]||[],ze(D[e],t))},r.removeHook=function(e){if(D[e])return Fe(D[e])},r.removeHooks=function(e){D[e]&&(D[e]=[])},r.removeAllHooks=function(){D={}}}else r.isSupported=!1;return r}(),bt=window,xt=document,wt=/^image\/(p?jpe?g|gif|png|bmp)$/i;function Ct(e,t){var n;P(e,(function(e){Y(e,!0)?(n||e.nodeType===d?/\S/.test(e.nodeValue):!D(e,".sceditor-ignore"))&&(n||R(n=m("p",{},t),e),y(n,e)):n=null}),!1,!0)}function Et(e,o){var i,c,f,p,M,P,q,$,X,Q,ee,oe,le,ce,de,pe,he,ge,ve,ye,we,Ce,Ee,Te,Se,ke,Ne,Ae,De,Re,Me,_e,Le,Oe,Ie,Be,He,Fe,ze,Pe,je,We,Ue,Ge,qe,Ve,Ye,$e,Ke,Xe,Ze,Qe,Je,et,tt,nt,rt,ot,it,at,lt=this,st={},ct=[],ut=[],dt={},ft={},pt={},mt=(lt.commands=a(!0,{},o.commands||ue),lt.opts=a(!0,{},re,o)),ht=(lt.opts.emoticons=o.emoticons||re.emoticons,Array.isArray(mt.allowedIframeUrls)||(mt.allowedIframeUrls=[]),mt.allowedIframeUrls.push("https://www.youtube-nocookie.com/embed/"),yt());function gt(e){var t=["iframe"].concat(mt.allowedTags),n=["allowfullscreen","frameborder","target"].concat(mt.allowedAttributes);return ht.sanitize(e,{ADD_TAGS:t,ADD_ATTR:n})}ht.addHook("uponSanitizeElement",(function(e,n){var r=mt.allowedIframeUrls;if("iframe"===n.tagName){for(var o=C(e,"src")||"",i=0;i<r.length;i++){var a=r[i];if(t(a)&&o.substr(0,a.length)===a)return;if(a.test&&a.test(o))return}v(e)}})),ht.addHook("afterSanitizeAttributes",(function(e){"target"in e&&C(e,"data-sce-target",C(e,"target")),E(e,"target")})),o=function(){function t(){w(bt,"load",t),mt.autofocus&&Qe(!!mt.autofocusEnd),at(),Ke(),ce.call("ready"),"onReady"in i&&i.onReady.call(lt)}e._sceditor=lt,mt.locale&&"en"!==mt.locale&&De(),R(c=m("div",{className:"sceditor-container"}),e),N(c,"z-index",mt.zIndex),ve=e.required,e.required=!1;var n=Et.formats[mt.format];i=n?new n:{},ce=new fe(lt),(mt.plugins||"").split(",").forEach((function(e){ce.register(e.trim())})),"init"in i&&i.init.call(lt),Oe(),Re(),Ae(),Me(),_e(),xe||lt.toggleSourceMode(),Ye(),x(bt,"load",t),"complete"===xt.readyState&&t()},De=function(){var e;(oe=Et.locale[mt.locale])||(e=mt.locale.split("-"),oe=Et.locale[e[0]]),oe&&oe.dateFormat&&(mt.dateFormat=oe.dateFormat)},Ae=function(){$=m("textarea"),p=m("iframe",{frameborder:0,allowfullscreen:!0}),mt.startInSourceMode?(L(c,"sourceMode"),T(p)):(L(c,"wysiwygMode"),T($)),mt.spellcheck||C(c,"spellcheck","false"),"https:"===bt.location.protocol&&C(p,"src","about:blank"),y(c,p),y(c,$),lt.dimensions(mt.width||B(e),mt.height||H(e));var t=be?" ios":"";(q=p.contentDocument).open(),q.write(se("html",{attrs:' class="'+t+'"',spellcheck:mt.spellcheck?"":'spellcheck="false"',charset:mt.charset,style:mt.style})),q.close(),P=q.body,M=p.contentWindow,lt.readOnly(!!mt.readOnly),be&&(H(P,"100%"),x(P,"touchend",lt.focus)),t=C(e,"tabindex"),C($,"tabindex",t),C(p,"tabindex",t),le=new me(M,null,gt),T(e),lt.val(e.value),(t=mt.placeholder||C(e,"placeholder"))&&($.placeholder=t,C(P,"placeholder",t))},Me=function(){mt.autoUpdate&&(x(P,"blur",it),x($,"blur",it)),null===mt.rtl&&(mt.rtl="rtl"===N($,"direction")),lt.rtl(!!mt.rtl),mt.autoExpand&&(x(P,"load",at,!0),x(P,"input keyup",at)),mt.resizeEnabled&&Le(),C(c,"id",mt.id),lt.emoticons(mt.emoticonsEnabled)},_e=function(){var t=e.form,n="compositionstart compositionend",r="keydown keyup keypress focus blur contextmenu input",o="onselectionchange"in q?"selectionchange":"keyup focus blur contextmenu mouseup touchend click";x(xt,"click",qe),t&&(x(t,"reset",je),x(t,"submit",lt.updateOriginal,!0)),x(window,"pagehide",lt.updateOriginal),x(window,"pageshow",je),x(P,"keypress",Pe),x(P,"keydown",Fe),x(P,"keydown",ze),x(P,"keyup",Ke),x(P,"blur",rt),x(P,"keyup",ot),x(P,"paste",Ie),x(P,"cut copy",Be),x(P,n,Ue),x(P,o,Xe),x(P,r,Ge),mt.emoticonsCompat&&bt.getSelection&&x(P,"keyup",et),x(P,"blur",(function(){lt.val()||L(P,"placeholder")})),x(P,"focus",(function(){O(P,"placeholder")})),x($,"blur",rt),x($,"keyup",ot),x($,"keydown",Fe),x($,n,Ue),x($,r,Ge),x(q,"mousedown",We),x(q,o,Xe),x(q,"keyup",Ke),x(c,"selectionchanged",Ze),x(c,"selectionchanged",Ye),x(c,"selectionchanged valuechanged nodechanged pasteraw paste",Ge)},Re=function(){var e,n=lt.commands,r=(mt.toolbarExclude||"").split(","),o=mt.toolbar.split("|");f=m("div",{className:"sceditor-toolbar",unselectable:"on"}),mt.icons in Et.icons&&(Se=new Et.icons[mt.icons]),s(o,(function(o,i){e=m("div",{className:"sceditor-group"}),s(i.split(","),(function(o,i){var a,l,s=n[i];!s||-1<r.indexOf(i)||(a=s.shortcut,l=se("toolbarButton",{name:i,dispName:lt._(s.name||s.tooltip||i)},!0).firstChild,Se&&Se.create&&Se.create(i)&&(R(Se.create(i),l.firstChild),L(l,"has-icon")),l._sceTxtMode=!!s.txtExec,l._sceWysiwygMode=!!s.exec,I(l,"disabled",!s.exec),x(l,"click",(function(e){_(l,"disabled")||Ne(l,s),Ye(),e.preventDefault()})),x(l,"mousedown",(function(e){lt.closeDropDown(),e.preventDefault()})),s.tooltip&&C(l,"title",lt._(s.tooltip)+(a?" ("+a+")":"")),a&&lt.addShortcut(a,i),s.state?ut.push({name:i,state:s.state}):t(s.exec)&&ut.push({name:i,state:s.exec}),y(e,l),ft[i]=l)})),e.firstChild&&y(f,e)})),y(mt.toolbarContainer||c,f)},Le=function(){var e=m("div",{className:"sceditor-grip"}),t=m("div",{className:"sceditor-resize-cover"}),n="touchmove mousemove",r="touchcancel touchend mouseup",o=0,i=0,a=0,l=0,s=0,u=0,d=B(c),f=H(c),p=!1,h=lt.rtl(),g=mt.resizeMinHeight||f/1.5,v=mt.resizeMaxHeight||2.5*f,b=mt.resizeMinWidth||d/1.25,C=mt.resizeMaxWidth||1.25*d,E=function(e){l=("touchmove"===e.type?(e=bt.event,a=e.changedTouches[0].pageX,e.changedTouches[0]):(a=e.pageX,e)).pageY;var t=u+(l-i),n=h?s-(a-o):s+(a-o);0<C&&C<n&&(n=C),0<b&&n<b&&(n=b),mt.resizeWidth||(n=!1),0<v&&v<t&&(t=v),0<g&&t<g&&(t=g),mt.resizeHeight||(t=!1),(n||t)&&lt.dimensions(n,t),e.preventDefault()},k=function(e){p&&(p=!1,T(t),O(c,"resizing"),w(xt,n,E),w(xt,r,k),e.preventDefault())};Se&&Se.create&&(f=Se.create("grip"))&&(y(e,f),L(e,"has-icon")),y(c,e),y(c,t),T(t),x(e,"touchstart mousedown",(function(e){i=("touchstart"===e.type?(e=bt.event,o=e.touches[0].pageX,e.touches[0]):(o=e.pageX,e)).pageY,s=B(c),u=H(c),p=!0,L(c,"resizing"),S(t),x(xt,n,E),x(xt,r,k),e.preventDefault()}))},Oe=function(){var e=mt.emoticons,t=mt.emoticonsRoot||"";s(pt=e?a({},e.more,e.dropdown,e.hidden):pt,(function(e,n){pt[e]=se("emoticon",{key:e,url:t+(n.url||n),tooltip:n.tooltip||e}),mt.emoticonsEnabled&&ct.push(m("img",{src:t+(n.url||n)}))}))},Qe=function(e){var t,n=P.firstChild;if(z(c))if(lt.sourceMode())t=e?$.value.length:0,$.setSelectionRange(t,t);else{if(Z(P),e)for((n=P.lastChild)||(n=m("p",{},q),y(P,n));n.lastChild;)D(n=n.lastChild,"br")&&n.previousSibling&&(n=n.previousSibling);t=q.createRange(),V(n)?t.selectNodeContents(n):(t.setStartBefore(n),e&&t.setStartAfter(n)),t.collapse(!e),le.selectRange(t),he=t,e&&(P.scrollTop=P.scrollHeight),lt.focus()}},lt.readOnly=function(e){return"boolean"!=typeof e?!$.readonly:(P.contentEditable=!e,$.readonly=!e,Ve(e),lt)},lt.rtl=function(e){var t=e?"rtl":"ltr";return"boolean"!=typeof e?"rtl"===C($,"dir"):(C(P,"dir",t),C($,"dir",t),O(c,"rtl"),O(c,"ltr"),L(c,t),Se&&Se.rtl&&Se.rtl(e),lt)},Ve=function(e){var t=lt.inSourceMode()?"_sceTxtMode":"_sceWysiwygMode";s(ft,(function(n,r){I(r,"disabled",e||!r[t])}))},lt.width=function(e,t){return e||0===e?(lt.dimensions(e,null,t),lt):B(c)},lt.dimensions=function(e,t,n){return t=!(!t&&0!==t)&&t,!1===(e=!(!e&&0!==e)&&e)&&!1===t?{width:lt.width(),height:lt.height()}:(!1!==e&&(!1!==n&&(mt.width=e),B(c,e)),!1!==t&&(!1!==n&&(mt.height=t),H(c,t)),lt)},lt.height=function(e,t){return e||0===e?(lt.dimensions(null,e,t),lt):H(c)},lt.maximize=function(e){var t="sceditor-maximize";return n(e)?_(c,t):((e=!!e)&&(Ee=bt.pageYOffset),I(xt.documentElement,t,e),I(xt.body,t,e),I(c,t,e),lt.width(e?"100%":mt.width,!1),lt.height(e?"100%":mt.height,!1),e||bt.scrollTo(0,Ee),at(),lt)},at=function(){mt.autoExpand&&!Ce&&(Ce=setTimeout(lt.expandToContent,200))},lt.expandToContent=function(t){var n,r;lt.maximize()||(clearTimeout(Ce),Ce=!1,we||(r=mt.resizeMinHeight||mt.height||H(e),we={min:r,max:mt.resizeMaxHeight||2*r}),(r=xt.createRange()).selectNodeContents(P),r=r.getBoundingClientRect(),n=q.documentElement.clientHeight-1,r=r.bottom-r.top,r=lt.height()+1+(r-n),t||-1===we.max||(r=Math.min(r,we.max)),lt.height(Math.ceil(Math.max(r,we.min))))},lt.destroy=function(){var t;ce&&(ce.destroy(),ce=le=null,X&&v(X),w(xt,"click",qe),(t=e.form)&&(w(t,"reset",je),w(t,"submit",lt.updateOriginal,!0)),w(window,"pagehide",lt.updateOriginal),w(window,"pageshow",je),v($),v(f),v(c),delete e._sceditor,S(e),e.required=ve)},lt.createDropDown=function(e,t,n){t="sceditor-"+t,lt.closeDropDown(),X&&_(X,t)||(e=a({top:e.offsetTop,left:e.offsetLeft,marginTop:e.clientHeight},mt.dropDownCss),N(X=m("div",{className:"sceditor-dropdown "+t}),e),y(X,n),y(c,X),x(X,"click focusin",(function(e){e.stopPropagation()})),X&&(t=b(X,"input,textarea")[0])&&t.focus())},qe=function(e){3!==e.which&&X&&!e.defaultPrevented&&(it(),lt.closeDropDown())},Be=function(e){var t=le.selectedRange();if(t){for(var n,r,o=m("div",{},q),i=t.commonAncestorContainer;i&&Y(i,!0);)i.nodeType===u&&(r=i.cloneNode(),o.firstChild&&y(r,o.firstChild),y(o,r),n=n||r),i=i.parentNode;y(n||o,t.cloneContents()),Z(o),e.clipboardData.setData("text/html",o.innerHTML),s(b(o,"p"),(function(e,t){G(t,"div")})),s(b(o,"br"),(function(e,t){t.nextSibling&&Y(t.nextSibling,!0)||v(t)})),y(P,o),e.clipboardData.setData("text/plain",o.innerText),v(o),"cut"===e.type&&t.deleteContents(),e.preventDefault()}},Ie=function(e){var t,n,r=P,o=e.clipboardData;if(o){var i={},a=o.types,l=o.items;e.preventDefault();for(var s=0;s<a.length;s++){if(a.indexOf("text/html")<0&&bt.FileReader&&l&&wt.test(l[s].type))return t=o.items[s].getAsFile(),n=void 0,(n=new FileReader).onload=function(e){He({html:'<img src="'+e.target.result+'" />'})},void n.readAsDataURL(t);i[a[s]]=o.getData(a[s])}i.text=i["text/plain"],i.html=gt(i["text/html"]),He(i)}else if(!Te){var c=r.scrollTop;for(le.saveRange(),Te=xt.createDocumentFragment();r.firstChild;)y(Te,r.firstChild);setTimeout((function(){var e=r.innerHTML;r.innerHTML="",y(r,Te),r.scrollTop=c,Te=!1,le.restoreRange(),He({html:gt(e)})}),0)}},He=function(e){var t=m("div",{},q);ce.call("pasteRaw",e),F(c,"pasteraw",e),e.html?(t.innerHTML=gt(e.html),K(t)):t.innerHTML=ae(e.text||""),e={val:t.innerHTML},"fragmentToSource"in i&&(e.val=i.fragmentToSource(e.val,q,de)),ce.call("paste",e),F(c,"paste",e),"fragmentToHtml"in i&&(e.val=i.fragmentToHtml(e.val,de)),ce.call("pasteHtml",e),t=le.getFirstBlockParent(),lt.wysiwygEditorInsertHtml(e.val,null,!0),function e(t){if(t.nodeType===u){for(var n=t.parentNode,r=t.tagName,o=t.childNodes.length;o--;)e(t.childNodes[o]);if(Y(t)&&"BR"!==r){for(o=t.style.length;o--;){var i=t.style[o];N(n,i)===N(t,i)&&t.style.removeProperty(i)}if(!t.style.length)if(E(t,"style"),"FONT"===r&&(N(t,"fontFamily").toLowerCase()===N(n,"fontFamily").toLowerCase()&&E(t,"face"),N(t,"color")===N(n,"color")&&E(t,"color"),N(t,"fontSize")===N(n,"fontSize")&&E(t,"size")),!t.attributes.length&&/SPAN|FONT/.test(r))ne(t);else if(/B|STRONG|EM|SPAN|FONT/.test(r))for(var a=/B|STRONG/.test(r),l="EM"===r;n&&Y(n)&&(!a||/bold|700/i.test(N(n,"fontWeight")))&&(!l||"italic"===N(n,"fontStyle"));){if((n.tagName===r||a&&/B|STRONG/.test(n.tagName))&&te(n,t)){ne(t);break}n=n.parentNode}var s=t.nextSibling;s&&s.tagName===r&&te(s,t)&&(y(t,s),ne(s))}}}(t)},lt.closeDropDown=function(e){X&&(v(X),X=null),!0===e&&lt.focus()},lt.wysiwygEditorInsertHtml=function(e,t,n){var r=H(p);lt.focus(),!n&&g(pe,"code")||(le.insertHTML(e,t),le.saveRange(),ke(),K(P),Ct(P,q),S(n=b(P,"#sceditor-end-marker")[0]),e=P.scrollTop,t=J(n).top+1.5*n.offsetHeight-r,T(n),(e<t||t+r<e)&&(P.scrollTop=t),nt(!1),le.restoreRange(),Ke())},lt.wysiwygEditorInsertText=function(e,t){lt.wysiwygEditorInsertHtml(ae(e),ae(t))},lt.insertText=function(e,t){return lt.inSourceMode()?lt.sourceEditorInsertText(e,t):lt.wysiwygEditorInsertText(e,t),lt},lt.sourceEditorInsertText=function(e,t){var n,r=$.selectionStart,o=$.selectionEnd,i=$.scrollTop;$.focus(),n=$.value,t&&(e+=n.substring(r,o)+t),$.value=n.substring(0,r)+e+n.substring(o,n.length),$.selectionStart=r+e.length-(t?t.length:0),$.selectionEnd=$.selectionStart,$.scrollTop=i,$.focus(),nt()},lt.getRangeHelper=function(){return le},lt.sourceEditorCaret=function(e){return $.focus(),e?($.selectionStart=e.start,$.selectionEnd=e.end,this):{start:$.selectionStart,end:$.selectionEnd}},lt.val=function(e,n){return t(e)?(lt.inSourceMode()?lt.setSourceEditorValue(e):(!1!==n&&"toHtml"in i&&(e=i.toHtml(e)),lt.setWysiwygEditorValue(e)),lt):lt.inSourceMode()?lt.getSourceEditorValue(!1):lt.getWysiwygEditorValue(n)},lt.insert=function(e,t,n,r,o){var a;return lt.inSourceMode()?lt.sourceEditorInsertText(e,t):(t&&(a=le.selectedHtml(),e+=(a=!1!==n&&"fragmentToSource"in i?i.fragmentToSource(a,q,de):a)+t),!1!==n&&"fragmentToHtml"in i&&(e=i.fragmentToHtml(e,de)),!1!==n&&!0===o&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")),lt.wysiwygEditorInsertHtml(e)),lt},lt.getWysiwygEditorValue=function(e){for(var t,n=m("div",{},q),r=P.childNodes,o=0;o<r.length;o++)y(n,r[o].cloneNode(!0));return y(P,n),K(n),v(n),t=n.innerHTML,!1!==e&&i.hasOwnProperty("toSource")?i.toSource(t,q):t},lt.getBody=function(){return P},lt.getContentAreaContainer=function(){return p},lt.getSourceEditorValue=function(e){var t=$.value;return!1!==e&&"toHtml"in i?i.toHtml(t):t},lt.setWysiwygEditorValue=function(e){P.innerHTML=gt(e=e||"<p><br /></p>"),ke(),Ke(),nt(),at()},lt.setSourceEditorValue=function(e){$.value=e,nt()},lt.updateOriginal=function(){e.value=lt.val()},ke=function(){var e,t,n,r,o,i,a;mt.emoticonsEnabled&&(e=P,t=pt,n=mt.emoticonsCompat,r=e.ownerDocument,o="(^|\\s| | | | |$)",i=[],a={},h(e,"code")||(s(t,(function(e){a[e]=new RegExp(o+ie(e)+o),i.push(e)})),i.sort((function(e,t){return t.length-e.length})),function e(o){for(o=o.firstChild;o;){if(o.nodeType!==u||D(o,"code")||e(o),o.nodeType===d)for(var l=0;l<i.length;l++){var s,c=o.nodeValue,f=i[l],p=n?c.search(a[f]):c.indexOf(f);-1<p&&(p=c.indexOf(f,p),s=W(t[f],r),f=c.substr(p+f.length),s.appendChild(r.createTextNode(f)),o.nodeValue=c.substr(0,p),o.parentNode.insertBefore(s,o.nextSibling))}o=o.nextSibling}}(e)))},lt.inSourceMode=function(){return _(c,"sourceMode")},lt.sourceMode=function(e){var t=lt.inSourceMode();return"boolean"!=typeof e?t:((t&&!e||!t&&e)&&lt.toggleSourceMode(),lt)},lt.toggleSourceMode=function(){var e=lt.inSourceMode();!xe&&e||(e||(le.saveRange(),le.clear()),he=null,lt.blur(),e?lt.setWysiwygEditorValue(lt.getSourceEditorValue()):lt.setSourceEditorValue(lt.getWysiwygEditorValue()),k($),k(p),I(c,"wysiwygMode",e),I(c,"sourceMode",!e),Ve(),Ye())},$e=function(){return $.focus(),$.value.substring($.selectionStart,$.selectionEnd)},Ne=function(e,t){lt.inSourceMode()?t.txtExec&&(Array.isArray(t.txtExec)?lt.sourceEditorInsertText.apply(lt,t.txtExec):t.txtExec.call(lt,e,$e())):t.exec&&(r(t.exec)?t.exec.call(lt,e):lt.execCommand(t.exec,t.hasOwnProperty("execParam")?t.execParam:null))},lt.execCommand=function(e,t){var n=!1,r=lt.commands[e];if(lt.focus(),!g(le.parentNode(),"code")){try{n=q.execCommand(e,!1,t)}catch(e){}!n&&r&&r.errorMessage&&alert(lt._(r.errorMessage)),Ye()}},Xe=function(){function e(){if(M.getSelection()&&M.getSelection().rangeCount<=0)he=null;else if(le&&!le.compare(he)){if((he=le.cloneSelected())&&he.collapsed){var e=he.startContainer,t=he.startOffset;for(t&&e.nodeType!==d&&(e=e.childNodes[t]);e&&e.parentNode!==P;)e=e.parentNode;e&&Y(e,!0)&&(le.saveRange(),Ct(P,q),le.restoreRange())}F(c,"selectionchanged")}ge=!1}ge||(ge=!0,"onselectionchange"in q?e():setTimeout(e,100))},Ze=function(){var e,t=le.parentNode();de!==t&&(e=de,de=t,pe=le.getFirstBlockParent(t),F(c,"nodechanged",{oldNode:e,newNode:de}))},lt.currentNode=function(){return de},lt.currentBlockNode=function(){return pe},Ye=function(){var e,n,r="active",o=q,i=lt.sourceMode();if(lt.readOnly())s(b(f,r),(function(e,t){O(t,r)}));else{i||(n=le.parentNode(),e=le.getFirstBlockParent(n));for(var a=0;a<ut.length;a++){var l=0,c=ft[ut[a].name],u=ut[a].state,d=i&&!c._sceTxtMode||!i&&!c._sceWysiwygMode;if(t(u)){if(!i)try{-1<(l=o.queryCommandEnabled(u)?0:-1)&&(l=o.queryCommandState(u)?1:0)}catch(e){}}else d||(l=u.call(lt,n,e));I(c,"disabled",d||l<0),I(c,r,0<l)}Se&&Se.update&&Se.update(i,n,e)}},Pe=function(e){var t,n,r;e.defaultPrevented||(lt.closeDropDown(),13===e.which&&!D(pe,"li,ul,ol")&&U(pe)&&(t=m("br",{},q),le.insertNode(t),(r=(n=t.parentNode).lastChild)&&r.nodeType===d&&""===r.nodeValue&&(v(r),r=n.lastChild),!Y(n,!0)&&r===t&&Y(t.previousSibling)&&le.insertHTML("<br>"),e.preventDefault()))},Ke=function(){j(P,(function(e){var t;return e.nodeType!==u||/inline/.test(N(e,"display"))||D(e,".sceditor-nlf")||!U(e)?!(3===e.nodeType&&!/^\s*$/.test(e.nodeValue)||D(e,"br"))&&void 0:((t=m("p",{},q)).className="sceditor-nlf",t.innerHTML="<br />",y(P,t),!1)}))},je=function(){lt.val(e.value)},We=function(){lt.closeDropDown()},lt._=function(){var e=arguments;return oe&&oe[e[0]]&&(e[0]=oe[e[0]]),e[0].replace(/\{(\d+)\}/g,(function(t,n){return void 0!==e[+n+1]?e[+n+1]:"{"+n+"}"}))},Ge=function(e){ce&&ce.call(e.type+"Event",e,lt);var t=(e.target===$?"scesrc":"scewys")+e.type;st[t]&&st[t].forEach((function(t){t.call(lt,e)}))},lt.bind=function(e,t,n,o){for(var i,a,l=(e=e.split(" ")).length;l--;)r(t)&&(i="scewys"+e[l],a="scesrc"+e[l],n||(st[i]=st[i]||[],st[i].push(t)),o||(st[a]=st[a]||[],st[a].push(t)),"valuechanged"===e[l]&&(nt.hasHandler=!0));return lt},lt.unbind=function(e,t,n,o){for(var i=(e=e.split(" ")).length;i--;)r(t)&&(n||l(st["scewys"+e[i]]||[],t),o||l(st["scesrc"+e[i]]||[],t));return lt},lt.blur=function(e,t,n){return r(e)?lt.bind("blur",e,t,n):(lt.sourceMode()?$:P).blur(),lt},lt.focus=function(e,t,n){if(r(e))lt.bind("focus",e,t,n);else if(lt.inSourceMode())$.focus();else{if(b(q,":focus").length)return;e=le.selectedRange(),he||Qe(!0),e&&1===e.endOffset&&e.collapsed&&(t=e.endContainer)&&1===t.childNodes.length&&D(t.firstChild,"br")&&(e.setStartBefore(t.firstChild),e.collapse(!0),le.selectRange(e)),M.focus(),P.focus()}return Ye(),lt},lt.keyDown=function(e,t,n){return lt.bind("keydown",e,t,n)},lt.keyPress=function(e,t,n){return lt.bind("keypress",e,t,n)},lt.keyUp=function(e,t,n){return lt.bind("keyup",e,t,n)},lt.nodeChanged=function(e){return lt.bind("nodechanged",e,!1,!0)},lt.selectionChanged=function(e){return lt.bind("selectionchanged",e,!1,!0)},lt.valueChanged=function(e,t,n){return lt.bind("valuechanged",e,t,n)},Je=function(e){var t=0,n=lt.emoticonsCache,r=String.fromCharCode(e.which);g(pe,"code")||(n||(n=[],s(pt,(function(e,r){n[t++]=[e,r]})),n.sort((function(e,t){return e[0].length-t[0].length})),lt.emoticonsCache=n,lt.longestEmoticonCode=n[n.length-1][0].length),!le.replaceKeyword(lt.emoticonsCache,!0,!0,lt.longestEmoticonCode,mt.emoticonsCompat,r)||mt.emoticonsCompat&&/^\s$/.test(r)||e.preventDefault())},et=function(){var e=pe,t=le,n=/[^\s\xA0\u2002\u2003\u2009]+/,r=e&&b(e,"img[data-sceditor-emoticon]");if(e&&r.length)for(var o=0;o<r.length;o++){var i,a,l,s,c=r[o],u=c.parentNode,f=c.previousSibling,p=c.nextSibling;(f&&n.test(f.nodeValue.slice(-1))||p&&n.test((p.nodeValue||"")[0]))&&(a=-1,l=(i=t.cloneSelected()).startContainer,s=f.nodeValue||"",s+=A(c,"sceditor-emoticon"),l===p&&(a=s.length+i.startOffset),l===e&&e.childNodes[i.startOffset]===p&&(a=s.length),l===f&&(a=i.startOffset),(p=p&&p.nodeType===d?p:u.insertBefore(u.ownerDocument.createTextNode(""),p)).insertData(0,s),v(f),v(c),-1<a&&(i.setStart(p,a),i.collapse(!0),t.selectRange(i)))}},lt.emoticons=function(e){return e||!1===e?((mt.emoticonsEnabled=e)?(x(P,"keypress",Je),lt.sourceMode()||(le.saveRange(),ke(),nt(!1),le.restoreRange())):(s(b(P,"img[data-sceditor-emoticon]"),(function(e,t){var n=A(t,"sceditor-emoticon");n=q.createTextNode(n),t.parentNode.replaceChild(n,t)})),w(P,"keypress",Je),nt()),lt):mt.emoticonsEnabled},lt.css=function(e){return ye||(ye=m("style",{id:"inline"},q),y(q.head,ye)),t(e)?(ye.styleSheet?ye.styleSheet.cssText=e:ye.innerHTML=e,lt):ye.styleSheet?ye.styleSheet.cssText:ye.innerHTML},Fe=function(e){var t=[],n={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|","[":"{","]":"}"},r={109:"-",110:"del",111:"/",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},o=e.which,i={8:"backspace",9:"tab",13:"enter",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"win",92:"win",93:"select",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[o]||String.fromCharCode(o).toLowerCase();(e.ctrlKey||e.metaKey)&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&(t.push("shift"),r[o]?i=r[o]:n[i]&&(i=n[i])),i&&(o<16||18<o)&&t.push(i),t=t.join("+"),dt[t]&&!1===dt[t].call(lt)&&(e.stopPropagation(),e.preventDefault())},lt.addShortcut=function(e,n){return e=e.toLowerCase(),t(n)?dt[e]=function(){return Ne(ft[n],lt.commands[n]),!1}:dt[e]=n,lt},lt.removeShortcut=function(e){return delete dt[e.toLowerCase()],lt},ze=function(e){var t,n,r;if(!mt.disableBlockRemove&&8===e.which&&(n=le.selectedRange())&&(t=n.startContainer,0===n.startOffset&&(r=tt())&&!D(r,"body"))){for(;t!==r;){for(;t.previousSibling;)if((t=t.previousSibling).nodeType!==d||t.nodeValue)return;if(!(t=t.parentNode))return}lt.clearBlockFormatting(r),e.preventDefault()}},tt=function(){for(var e=pe;!U(e)||Y(e,!0);)if(!(e=e.parentNode)||D(e,"body"))return;return e},lt.clearBlockFormatting=function(e){return(e=e||tt())&&!D(e,"body")&&(le.saveRange(),e.className="",C(e,"style",""),D(e,"p,div,td")||G(e,"p"),le.restoreRange()),lt},nt=function(e){var t,n,r;ce&&(ce.hasHandler("valuechangedEvent")||nt.hasHandler)&&(r=!(n=lt.sourceMode())&&le.hasSelection(),e=(Q=!1)!==e&&!q.getElementById("sceditor-start-marker"),ee&&(clearTimeout(ee),ee=!1),r&&e&&le.saveRange(),(t=n?$.value:P.innerHTML)!==nt.lastVal&&(nt.lastVal=t,F(c,"valuechanged",{rawValue:n?lt.val():t})),r&&e&&le.removeMarkers())},rt=function(){ee&&nt()},ot=function(e){e=e.which;var t=13===(n=ot.lastChar)||32===n,n=8===n||46===n;ot.lastChar=e,Q||(13===e||32===e?t?ot.triggerNext=!0:nt():8===e||46===e?n?ot.triggerNext=!0:nt():ot.triggerNext&&(nt(),ot.triggerNext=!1),clearTimeout(ee),ee=setTimeout((function(){Q||nt()}),1500))},Ue=function(e){(Q=/start/i.test(e.type))||nt()},it=function(){lt.updateOriginal()},o()}Et.locale={},Et.formats={},Et.icons={},Et.command={get:function(e){return ue[e]||null},set:function(e,t){return!(!e||!t)&&((t=a(ue[e]||{},t)).remove=function(){Et.command.remove(e)},ue[e]=t,this)},remove:function(e){return ue[e]&&delete ue[e],this}},window.sceditor={command:Et.command,commands:ue,defaultOptions:re,ios:be,isWysiwygSupported:xe,regexEscape:ie,escapeEntities:ae,escapeUriScheme:function(e){var t,n=window.location;return e&&/^[^\/]*:/i.test(e)&&!oe.test(e)?((t=n.pathname.split("/")).pop(),n.protocol+"//"+n.host+t.join("/")+"/"+e):e},dom:{css:N,attr:C,removeAttr:E,is:D,closest:g,width:B,height:H,traverse:P,rTraverse:j,parseHTML:W,hasStyling:U,convertElement:G,blockLevelList:q,canHaveChildren:V,isInline:Y,copyCSS:function(e,t){t.style&&e.style&&(t.style.cssText=e.style.cssText+t.style.cssText)},fixNesting:K,findCommonAncestor:function(e,t){for(;e=e.parentNode;)if((n=e)!==(r=t)&&n.contains&&n.contains(r))return e;var n,r},getSibling:X,removeWhiteSpace:Z,extractContents:Q,getOffset:J,getStyle:ee,hasStyle:function(e,t,n){return!!(e=ee(e,t))&&(!n||e===n||Array.isArray(n)&&-1<n.indexOf(e))}},locale:Et.locale,icons:Et.icons,utils:{each:s,isEmptyObject:i,extend:a},plugins:fe.plugins,formats:Et.formats,create:function(e,t){t=t||{},h(e,".sceditor-container")||(t.runWithoutWysiwygSupport||xe)&&new Et(e,t)},instance:function(e){return e._sceditor}}}()},630:e=>{!function(){var t=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],n="undefined"!=typeof window,r=n&&null!=window.mozInnerScreenX;function o(e,o,i){if(!n)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var a=i&&i.debug||!1;if(a){var l=document.querySelector("#input-textarea-caret-position-mirror-div");l&&l.parentNode.removeChild(l)}var s=document.createElement("div");s.id="input-textarea-caret-position-mirror-div",document.body.appendChild(s);var c=s.style,u=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,d="INPUT"===e.nodeName;c.whiteSpace="pre-wrap",d||(c.wordWrap="break-word"),c.position="absolute",a||(c.visibility="hidden"),t.forEach((function(e){d&&"lineHeight"===e?c.lineHeight=u.height:c[e]=u[e]})),r?e.scrollHeight>parseInt(u.height)&&(c.overflowY="scroll"):c.overflow="hidden",s.textContent=e.value.substring(0,o),d&&(s.textContent=s.textContent.replace(/\s/g," "));var f=document.createElement("span");f.textContent=e.value.substring(o)||".",s.appendChild(f);var p={top:f.offsetTop+parseInt(u.borderTopWidth),left:f.offsetLeft+parseInt(u.borderLeftWidth),height:parseInt(u.lineHeight)};return a?f.style.backgroundColor="#aaa":document.body.removeChild(s),p}void 0!==e.exports?e.exports=o:n&&(window.getCaretCoordinates=o)}()}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=flarum.core.compat["common/app"];var t=n.n(e);t().initializers.add("foskym/flarum-wysiwyg-editor",(function(){console.log("[foskym/flarum-wysiwyg-editor] Hello, forum and admin!")}));const r=flarum.core.compat["forum/app"];var o=n.n(r);const i=flarum.core.compat["common/extend"],a=flarum.core.compat["common/components/Button"];var l=n.n(a);const s=flarum.core.compat["common/components/TextEditor"];var c=n.n(s);const u=flarum.core.compat["forum/components/Composer"];var d=n.n(u);const f=flarum.core.compat["common/components/Tooltip"];var p=n.n(f);const h=flarum.core.compat["common/utils/classList"];var g=n.n(h),v=(n(368),n(689),n(630)),y=n.n(v),b=0,x=function(){function e(){this.debug=b++,this.attributes={},this.rejected=!1,this.beforeTemplate=!0,this.templatePatternBefore=[],this.templatePatternAfter=[]}var t=e.prototype;return t.content=function(e){this.beforeTemplate?this.templatePatternBefore.push(e):this.templatePatternAfter.push(e)},t.pattern=function(){return"^"+this.templatePatternBefore.map((function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})).join("\\s*?")+"([^]*)"+this.templatePatternAfter.map((function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})).join("\\s*?")},t.merge=function(e){var t=this;e.isRejected()||(Object.keys(e.attributes).forEach((function(n){t.attributes[n]=e.attributes[n]})),this.beforeTemplate?(e.templatePatternBefore.forEach((function(e){return t.templatePatternBefore.push(e)})),e.beforeTemplate||(e.templatePatternAfter.forEach((function(e){return t.templatePatternAfter.push(e)})),this.beforeTemplate=!1)):(e.templatePatternBefore.forEach((function(e){return t.templatePatternAfter.push(e)})),e.templatePatternAfter.forEach((function(e){return t.templatePatternAfter.push(e)}))))},t.attr=function(e){return this.attributes[e]},t.setAttr=function(e,t){this.attributes[e]=t},t.reject=function(){return this.rejected=!0,!1},t.isRejected=function(){return this.rejected},e}(),w={target:"data-sce-target"};function C(e){if(e.nodeName)return e;if("object"==typeof e){if(Array.isArray(e))return e.map((function(e){return C(e)}));var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=C(e[n]));return t}return e}function E(e){return"#text"===e.nodeName.toLowerCase()?e.textContent||"":e.innerText||""}var T=function(){function e(e){this.template=void 0,this.template=e.cloneNode(!0)}var t=e.prototype;return t.matchAttributes=function(e){var t=new x;return this.match(e,this.template.firstChild,t),!t.isRejected()&&(t.setAttr("@pattern",t.pattern()),t.attributes)},t.match=function(e,t,n,r){if(void 0===r&&(r=!1),e.nodeName.toLowerCase()!=t.nodeName.toLowerCase())return n.reject();if(this.checkAndUpdateAttr(e,t,n),!n.isRejected()&&!r){var o=Array.from(t.childNodes),i=Array.from(e.childNodes);if(0==i.length||0==o.length)return 0!=i.length?n.reject():void 0;this.processChildren([i],[o],[0],[0],n)}},t.checkAndUpdateAttr=function(e,t,n){for(var r=t.attributes,o=0;o<r.length;o++){var i=r[o],a=e.getAttribute(i.name);if(!a&&w[i.name]&&(a=e.getAttribute(w[i.name])),null===a)return n.reject();if(!this.attributeCheck(a,i,n))return n.reject()}return!0},t.attributeCheck=function(e,t,n){if(/\{@(.*?)\}/gi.test(t.value)){var r,o=Array.from(t.value.matchAll(/\{@(.+?)\}/gi)).map((function(e){return e&&e.length>1&&e[1]})).filter((function(e){return!!e})),i=null==(r=new RegExp("^"+t.value.replace(/\{@(.+?)\}/gi,"(.+?)")+"$").exec(e))?void 0:r.slice(1);if(!i||(null==i?void 0:i.length)!=o.length)return n.reject();for(var a=0;a<o.length;a++){var l=o[a],s=i[a];if(!l||!s)return n.reject();n.setAttr(l,s)}}else if(t.value!==e)return n.reject();return!0},t.processChildren=function(e,t,n,r,o,i){if(void 0===i&&(i=!1),0!=t.length){if(0!=e.length){var a=t[0][r[0]],l=e[0][n[0]];if(a.nodeName.toLowerCase().startsWith("xsl:")){var s=new x;if(this.processXSLTCondition(a,l,s)){var c=C(t),u=C(r),d=C(e),f=C(n);c.unshift(Array.from(a.childNodes)),u.unshift(0),this.processChildren(d,c,f,u,s,!0)}if(!s.isRejected())return void o.merge(s);if(r[0]++,r[0]>=t[0].length){if(i)return void o.reject();r.shift(),t.shift()}this.processChildren(C(e),C(t),C(n),C(r),o)}else{if("#text"==l.nodeName.toLowerCase()&&"#text"==a.nodeName.toLowerCase()){var p,m,h=((null==(p=a.textContent)?void 0:p.replace(/ \s+/gi," "))||"").trim(),g=((null==(m=l.textContent)?void 0:m.replace(/ \s+/gi," "))||"").trim();if(g!=h)if(g&&g.startsWith(h)){var v=C(t),y=C(r),b=C(e),w=C(n),E=l.cloneNode();E.textContent=g.substring(h.length),b[0].splice(w[0]+1,0,E),w[0]++,y[0]++,w[0]>=b[0].length&&(b.shift(),v.shift()),o.content(h),this.processChildren(b,v,w,y,o)}else o.reject();else o.content(g)}else this.match(l,a,o);if(o.isRejected())return;n[0]++,r[0]++,r[0]>=t[0].length&&(r.shift(),t.shift()),n[0]>=e[0].length&&(n.shift(),e.shift()),this.processChildren(C(e),C(t),C(n),C(r),o)}}}else e.length>0&&o.reject()},t.processXSLTCondition=function(e,t,n){var r=e.nodeName.toLowerCase();if("xsl:if"==r||"xsl:choose"==r){var o=e.getAttribute("test"),i=null==o?void 0:o.match(/([@A-Za-z0-9_'"\{\}]+)=([@A-Za-z0-9_'"\{\}]+)/);if(i){var a=i[1],l=i[2];a.startsWith("@")&&!l.startsWith("@")?n.setAttr(a.slice(1),l):l.startsWith("@")&&!a.startsWith("@")&&n.setAttr(l.slice(1),a)}}if("xsl:value-of"==r){var s=e.getAttribute("select"),c=null==s?void 0:s.match(/@([A-Za-z0-9_'"\{\}]+)/);return c&&n.setAttr(c[1],E(t)),n.content(E(t)),!1}return"xsl:apply-templates"!=r||(n.beforeTemplate=!1,n.setAttr("@template",E(t)),!1)},e}();function S(e){var t=s9e.TextFormatter.tagsConfig[e.toUpperCase()];if(!t)return!1;var n=Object.keys(t.attributes).map((function(e){return e+"=0 "})).join(" "),r="["+e+" "+n+"][/"+e+"]",o="["+e+" "+n+"]",i=s9e.TextFormatter.parse(r),a=s9e.TextFormatter.parse(o);return i.replace("<e>[/"+e+"]</e>","")!==a}var k=["TABLE","THEAD","TH","TR","TD","TBODY"];function N(e){return function(t,n){if(console.log("✨H->B",t,n),t.getAttribute("data-template-match-name")===e.name.toLowerCase()){var r=e.matching.matchAttributes(t);if(!1===r)return console.log("❌Template does not match",e.name),n;var o=Object.keys(r).filter((function(e){return"@template"!=e&&"@pattern"!=e})).map((function(e){return e+"="+r[e]})).join(" "),i=e.selfClose?"":"[/"+e.name.toUpperCase()+"]";return n=(new RegExp(r["@pattern"],"img").exec(n)||["",n])[1]||"",r["@template"]=n,console.log("✅Match",r,n),"["+e.name.toUpperCase()+" "+o+"]"+(r["@template"]||"")+i}return console.log("❓Missing tag",n),n}}var A={bold:{shortcut:"Ctrl+B",tag:"b"},italic:{shortcut:"Ctrl+I",tag:"i"},underline:{shortcut:"Ctrl+U",tag:"u"}},D=["b","i","u","s","sub","sup","font","size","color","ul","list","ol","li","*","table","tr","th","td","emoticon","hr","img","url","email","quote","code","left","center","right","justify","youtube","rtl","ltr"],R=function(){function e(e,t){var n,r,o,i,a;this.el=void 0,this.tempEl=void 0,this._textarea=void 0,this.view=null,this.params=null,this.instance=null,this.editor=null,this.rangeHelper=null,this.extraBBcode=[],this.s9ePreview=void 0,this._textarea=this.tempEl=this.el=document.createElement("textarea"),this.s9ePreview=document.createElement("div"),this.extraBBcode=(o=(new DOMParser).parseFromString(s9e.TextFormatter.xsl,"text/xml"),i=[],a=o.documentElement,Array.from(a.getElementsByTagName("xsl:template")).forEach((function(e){var t,n=e.getAttribute("match");if(!(null===n||n.indexOf("|")>-1)&&function(e){if(k.includes(e.toUpperCase()))return!0;var t=s9e.TextFormatter.tagsConfig[e.toUpperCase()];if(!t)return!1;var n="["+[e].concat(Object.keys(t.attributes).map((function(e){return e+"=0 "}))).join(" ")+"][/"+e+"]";return s9e.TextFormatter.parse(n).includes("<"+e.toUpperCase())}(n)){var r=e.innerHTML,o=(null==(t=e.firstElementChild)?void 0:t.tagName)||"";o&&i.push({name:n,parentName:o,content:r,selfClose:S(n),matching:new T(e)})}})),i),this.build(e,t),this.el=this.tempEl=(n=this.tempEl,r=this.instance,new Proxy(n,{get:function(e,t){if("focus"===t){if(r.sourceMode())return e.focus.bind(e);r.getRangeHelper().selectedRange().collapsed?r.insert("WYSIWGY_FLAG_SELECTRANGESTART"):r.insert("WYSIWGY_FLAG_SELECTRANGESTART","WYSIWGY_FLAG_SELECTRANGEEND");var n=r.val(),o=n.indexOf("WYSIWGY_FLAG_SELECTRANGESTART"),i=n.indexOf("WYSIWGY_FLAG_SELECTRANGEEND");return e.value=n.replace(/WYSIWGY_FLAG_SELECTRANGESTART/g,"").replace(/WYSIWGY_FLAG_SELECTRANGEEND/g,""),-1!==o&&-1!==i&&e.setSelectionRange(o,i-29),e.focus.bind(e)}if("value"===t)return e.value;var a=Reflect.get(e,t);return"function"==typeof a?a.bind(e):a},set:function(e,t,n){if("value"===t){e.value=n,r.sourceMode()||r.val(n,!0);var o=new CompositionEvent("compositionend",{bubbles:!0,cancelable:!0,data:n});e.dispatchEvent(o)}return Reflect.set(e,t,n)}}))}var t=e.prototype;return t.build=function(e,t){var n=this;this.tempEl.className=t.classNames.join(" "),this.tempEl.disabled=t.disabled,this.tempEl.placeholder=t.placeholder,this.tempEl.value=t.value,e.append(this.tempEl),this.s9ePreview.className="Post-body s9e-preview bbcode-editor-preview",this.s9ePreview.style.display="none",e.append(this.s9ePreview),this.params=t;var r=window.sceditor;D.forEach((function(e){return r.formats.bbcode.remove(e)})),this.extraBBcode.forEach((function(e){var t,o,i=e.name.toLowerCase();console.log("☘️Adding Template",i,e),r.formats.bbcode.set(i,{tags:(t={},t[e.parentName]={"data-template-match-name":e.name.toLowerCase()},t),allowsEmpty:!0,isSelfClosing:e.selfClose,format:N(e),html:(o=n.s9ePreview,function(e,t,n){var r;console.log("🎈B->H",e,n);var i=e.val+"FLAT_WYSIWYG_CONTENT_PLACEHOLDER";null!=(r=e.closing)&&r.val&&(i+=e.closing.val),s9e.TextFormatter.preview(i,o);var a=$(o).html();return $(o).html(""),a.startsWith("<p>")&&a.endsWith("</p>")&&(a=a.substring(3,a.length-4)),a.replace(/FLAT_WYSIWYG_CONTENT_PLACEHOLDER/g,n)})})})),r.create(this.tempEl,{format:"bbcode",style:"/assets/extensions/foskym-wysiwyg-editor/content.min.css",toolbar:"",locale:"cn",emoticonsEnabled:!1,startInSourceMode:!1,resizeEnabled:!1,dateFormat:"yyyy-mm-dd",rtl:!1}),this.editor=r,this.instance=r.instance(this.tempEl),function(e){for(var t=function(){var t=r[n],o=(t[0],t[1]);e.addShortcut(o.shortcut,(function(){e.inSourceMode()||setTimeout((function(){var t=e.currentNode();(t=t.parentElement).tagName===o.tag.toUpperCase()&&t.setAttribute("data-template-match-name",o.tag)}),10)}))},n=0,r=Object.entries(A);n<r.length;n++)t()}(this.instance),this.rangeHelper=this.instance.getRangeHelper(),(t.classNames||[]).forEach((function(e){var t;return null==(t=n.instance)?void 0:t.css(e)})),this.instance.width("100%");var o=document.documentElement,i=getComputedStyle(o).getPropertyValue("--body-bg").trim(),a=getComputedStyle(o).getPropertyValue("--control-color").trim();this.instance.css("body {background-color: "+i+"; color: "+a+" !important;}"),this.instance.focus();var l=this.instance.getContentAreaContainer();this.tempEl=$(l.parentElement).find("textarea")[0];var s=function(e){var t;null==(t=n.params)||t.inputListeners.forEach((function(e){e.call(l)})),e.redraw=!1};this.el.oninput=s,this.el.onclick=s,this.el.onkeyup=s,["keyup","keydown","keypress","blur","focus"].forEach((function(e){n.instance.bind(e,(function(e){t.oninput(n.instance.val()),s(e)}))}));var c=l.contentDocument,u=c.body;u.classList.add("bbcode-editor-content"),u.classList.add("Post-body");var d=c.head;document.head.querySelectorAll("link").forEach((function(e){e.href.indexOf("forum")>-1&&d.appendChild(e.cloneNode(!0))}))},t.getInstance=function(){return this.instance},t.moveCursorTo=function(e){this.setSelectionRange(e,e)},t.getSelectionRange=function(){var e=this.rangeHelper.selectedRange();return[e.startOffset,e.endOffset]},t.getLastNChars=function(e){return this.instance.val().slice(Math.max(0,this.getSelectionRange()[0]-e),this.getSelectionRange()[0])},t.insertAtCursor=function(e){this.insertAt(this.getSelectionRange()[0],e)},t.insertAt=function(e,t){this.insertBetween(e,e,t)},t.insertBetween=function(e,t,n){this.setSelectionRange(e,t),this.instance.insert(n)},t.replaceBeforeCursor=function(e,t){this.insertBetween(e,this.getSelectionRange()[0],t)},t.setSelectionRange=function(e,t){var n=document.createRange();n.setStart(this.el,e),n.setEnd(this.el,t),this.rangeHelper.selectRange(n),this.focus()},t.getTextNodeWidth=function(e){var t=document.createElement("span");t.textContent=e.nodeValue;var n=window.getComputedStyle(e.parentNode);t.style.fontSize=n.fontSize,t.style.fontFamily=n.fontFamily,t.style.whiteSpace="nowrap",t.style.position="absolute",t.style.visibility="hidden",document.body.appendChild(t);var r=t.getBoundingClientRect().width;return document.body.removeChild(t),r},t.getCaretCoordinates=function(e){if(this.instance.sourceMode()){var t=y()(this.el,e);return{top:t.top-this.el.scrollTop,left:t.left}}var n=this.instance.currentNode();if(!n)return{top:0,left:0};if(3===n.nodeType){var r=n.parentNode,o=this.getTextNodeWidth(n),i=r.getBoundingClientRect(),a=i.left+o,l=i.top+i.height;return console.log(r,a,l),{left:a,top:l}}var s=n.getBoundingClientRect(),c=s.left+s.width,u=s.top+s.height;return console.log(n,c,u),{left:c,top:u}},t.focus=function(){this.instance.focus()},t.destroy=function(){this.instance.destroy()},t.disabled=function(e){this.instance.readOnly(e)},e}(),M="B|DEL|EM|H1|H2|H3|H4|H5|H6|I|INS|LI|S|STRONG|SUB|SUP|TABLE|TBODY|THEAD|TR|U|p";function _(){var e,t=(new DOMParser).parseFromString(s9e.TextFormatter.xsl,"text/xml"),n=t.querySelector("template[match='"+M+"']");n&&(n.remove(),function(e){M.split("|").map((function(t){var n;if("p"!=t){var r=t.toLowerCase(),o=e.createElement("xsl:template");o.setAttribute("match",""+t),o.innerHTML="<"+r+"><xsl:apply-templates/></"+r+">",null==(n=e.firstChild)||n.appendChild(o)}}))}(t)),e=t,Array.from(e.querySelectorAll("template")).forEach((function(t){if(0!==t.childNodes.length){if(t.childNodes.length>1){var n=e.ownerDocument.createElement("div");n.append.apply(n,Array.from(t.childNodes)),t.append(n)}t.childNodes[0].setAttribute("data-template-match-name",(t.getAttribute("match")||"").toLowerCase())}})),s9e.TextFormatter.xsl=t.documentElement.outerHTML,s9e.TextFormatter.xslt.init(s9e.TextFormatter.xsl)}o().initializers.add("foskym/flarum-wysiwyg-editor",(function(){var e;_(),_(),e=null,(0,i.extend)(c().prototype,"controlItems",(function(t){t.add("rich-text",m(p(),{text:"切换富文本模式"},m(l(),{icon:"fas fa-pen-fancy",className:g()({Button:!0,"Button--icon":!0}),onclick:function(){e.toggleSourceMode()}})),-10)})),(0,i.extend)(c().prototype,"toolbarItems",(function(e){e.remove("markdown")})),(0,i.extend)(c().prototype,"buildEditorParams",(function(e){e.classNames.push("Post-body"),e.escape=function(){return t().composer.close()},m.redraw()})),(0,i.override)(c().prototype,"buildEditor",(function(t,n){var r=new R(n,this.buildEditorParams());return e=r.getInstance(),r})),(0,i.extend)(d().prototype,"updateHeight",(function(){if(e){var t=parseInt($(".Composer-content").css("padding-top").replace("px",""))||0,n=$(".ComposerBody-header").outerHeight()||0,r=$(".Composer-footer").outerHeight()||0,o=parseInt($(".Composer-footer").css("padding-bottom").replace("px",""))||0,i=($(".Composer").outerHeight()||0)-t-n-r-o;e.height(i)}}))}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map